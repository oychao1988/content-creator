# AI-Native å·¥ä½œæµè„šæ‰‹æ¶ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

AI-Native å·¥ä½œæµè„šæ‰‹æ¶æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„å·¥å…·ï¼Œè®©ä½ èƒ½å¤Ÿç”¨**è‡ªç„¶è¯­è¨€**æè¿°éœ€æ±‚ï¼Œè‡ªåŠ¨ç”Ÿæˆå®Œæ•´å¯ç”¨çš„ LangGraph å·¥ä½œæµä»£ç ã€‚æ— éœ€æ‰‹åŠ¨ç¼–å†™ç¹ççš„èŠ‚ç‚¹ç±»ã€çŠ¶æ€æ¥å£ã€å›¾å®šä¹‰ç­‰ä»£ç ï¼ŒAI ä¼šå¸®ä½ å®Œæˆä¸€åˆ‡ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¤– **AI é©±åŠ¨**ï¼šä½¿ç”¨ LLM ç†è§£è‡ªç„¶è¯­è¨€éœ€æ±‚
- ğŸ“Š **å¯è§†åŒ–é¢„è§ˆ**ï¼šç”Ÿæˆ Mermaid æµç¨‹å›¾å’Œæ•°æ®æµå›¾
- âœ… **è´¨é‡éªŒè¯**ï¼šåŒå±‚è´¨é‡æ£€æŸ¥ï¼ˆç¡¬è§„åˆ™ + LLM è¯„ä¼°ï¼‰
- ğŸ”„ **è‡ªåŠ¨ä¼˜åŒ–**ï¼šAI è‡ªåŠ¨ä¼˜åŒ–è¶…æ—¶ã€é‡è¯•ç­‰é…ç½®
- ğŸ“¦ **å¼€ç®±å³ç”¨**ï¼šç”Ÿæˆå®Œæ•´å¯è¿è¡Œçš„å·¥ä½œæµä»£ç 

---

## å¿«é€Ÿå¼€å§‹

### 5 åˆ†é’Ÿä¸Šæ‰‹

#### 1. ç¡®ä¿ç¯å¢ƒé…ç½®

```bash
# éªŒè¯ç¯å¢ƒå˜é‡
pnpm run verify-env

# ç¡®ä¿ LLM æœåŠ¡å·²é…ç½®
echo $LLM_SERVICE_TYPE  # api æˆ– cli
echo $LLM_API_KEY       # å¦‚æœä½¿ç”¨ API æ¨¡å¼
```

#### 2. åˆ›å»ºç¬¬ä¸€ä¸ªå·¥ä½œæµ

```bash
pnpm run cli workflow "åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦"
```

#### 3. æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç 

ç”Ÿæˆçš„ä»£ç ä¼šä¿å­˜åœ¨å½“å‰ç›®å½•ï¼š

```
text-summarizer/
â”œâ”€â”€ TextSummarizerState.ts      # çŠ¶æ€æ¥å£
â”œâ”€â”€ nodes/
â”‚   â”œâ”€â”€ SummarizeNode.ts         # æ‘˜è¦èŠ‚ç‚¹
â”‚   â””â”€â”€ CalculateLengthNode.ts   # é•¿åº¦è®¡ç®—èŠ‚ç‚¹
â”œâ”€â”€ TextSummarizerGraph.ts       # å·¥ä½œæµå›¾
â”œâ”€â”€ TextSummarizerFactory.ts     # å·¥å‚ç±»
â””â”€â”€ index.ts                     # å¯¼å‡ºæ–‡ä»¶
```

#### 4. æ³¨å†Œå¹¶ä½¿ç”¨

åœ¨ `src/domain/workflow/WorkflowRegistry.ts` ä¸­æ³¨å†Œï¼š

```typescript
import { TextSummarizerFactory } from './text-summarizer/index.js';

WorkflowRegistry.register(new TextSummarizerFactory());
```

ä½¿ç”¨å·¥ä½œæµï¼š

```bash
pnpm run cli create --type text-summarizer --sourceText "è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡æœ¬..." --maxLength 200
```

---

## æ ¸å¿ƒæ¦‚å¿µ

### 1. AI éœ€æ±‚ç†è§£

AI éœ€æ±‚ç†è§£å¼•æ“æ˜¯ä½ çš„"ç¿»è¯‘å®˜"ï¼Œå°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºç»“æ„åŒ–çš„å·¥ä½œæµè§„èŒƒã€‚

**è¾“å…¥**ï¼šè‡ªç„¶è¯­è¨€æè¿°
```
"åˆ›å»ºä¸€ä¸ªæƒ…æ„Ÿåˆ†æå·¥ä½œæµï¼Œè¾“å…¥è¯„è®ºæ–‡æœ¬ï¼Œè¾“å‡ºæ­£é¢/è´Ÿé¢/ä¸­æ€§åˆ†ç±»"
```

**è¾“å‡º**ï¼šç»“æ„åŒ– JSON è§„èŒƒ
```json
{
  "type": "sentiment-analyzer",
  "name": "æƒ…æ„Ÿåˆ†æå·¥ä½œæµ",
  "category": "analysis",
  "nodes": [
    {
      "name": "analyze",
      "nodeType": "llm",
      "llmSystemPrompt": "åˆ†ææ–‡æœ¬æƒ…æ„Ÿ..."
    }
  ],
  "connections": [...]
}
```

### 2. å¯è§†åŒ–é¢„è§ˆ

åœ¨ç”Ÿæˆä»£ç å‰ï¼Œä½ å¯ä»¥é¢„è§ˆå·¥ä½œæµçš„å¯è§†åŒ–è¡¨ç¤ºï¼š

- **Mermaid æµç¨‹å›¾**ï¼šèŠ‚ç‚¹è¿æ¥å’Œæ¡ä»¶åˆ†æ”¯
- **èŠ‚ç‚¹è¡¨æ ¼**ï¼šèŠ‚ç‚¹ç±»å‹ã€è¶…æ—¶ã€ä¾èµ–
- **æ•°æ®æµå›¾**ï¼šè¾“å…¥ â†’ å¤„ç† â†’ è¾“å‡º

ç¤ºä¾‹è¾“å‡ºï¼š
```
å·¥ä½œæµé¢„è§ˆï¼šæƒ…æ„Ÿåˆ†æå·¥ä½œæµ

Mermaid æµç¨‹å›¾:
graph LR
    START-->analyze
    analyze-->END

èŠ‚ç‚¹åˆ—è¡¨:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èŠ‚ç‚¹åç§°      â”‚ ç±»å‹ â”‚ è¶…æ—¶   â”‚ ä¾èµ–    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ analyze      â”‚ llm  â”‚ 60000  â”‚ æ—       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ•°æ®æµ:
ğŸ“¥ è¾“å…¥: commentText (string*)
âš™ï¸  å¤„ç†: analyze (æƒ…æ„Ÿåˆ†æ)
ğŸ“¤ è¾“å‡º: sentiment (string), confidence (number)
```

### 3. ä»£ç ç”Ÿæˆ

AI ä»£ç ç”Ÿæˆå™¨ä¼šåˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š

#### çŠ¶æ€æ¥å£ (`WorkflowState.ts`)
```typescript
export interface SentimentAnalyzerState extends BaseWorkflowState {
  commentText: string;
  sentiment?: 'positive' | 'negative' | 'neutral';
  confidence?: number;
  retryCount: number;
}
```

#### èŠ‚ç‚¹ç±» (`nodes/AnalyzeNode.ts`)
```typescript
class AnalyzeNode extends BaseNode<SentimentAnalyzerState> {
  protected async executeLogic(state: SentimentAnalyzerState) {
    const response = await this.llmService.chat({
      messages: [
        { role: 'system', content: 'åˆ†ææ–‡æœ¬æƒ…æ„Ÿ...' },
        { role: 'user', content: state.commentText }
      ]
    });

    return {
      sentiment: response.sentiment,
      confidence: response.confidence
    };
  }
}
```

#### å·¥ä½œæµå›¾ (`WorkflowGraph.ts`)
```typescript
export function createSentimentAnalyzerGraph() {
  return new StateGraph(SentimentAnalyzerState)
    .addNode('analyze', new AnalyzeNode())
    .addEdge('START', 'analyze')
    .addEdge('analyze', 'END')
    .compile();
}
```

#### å·¥å‚ç±» (`WorkflowFactory.ts`)
```typescript
export class SentimentAnalyzerFactory implements WorkflowFactory {
  readonly type = 'sentiment-analyzer';

  createGraph() { return createSentimentAnalyzerGraph(); }
  createState(params) { return { ...params, retryCount: 0 }; }
  validateParams(params) { return !!params.commentText; }
}
```

### 4. è´¨é‡éªŒè¯

ä¸¤å±‚è´¨é‡æ£€æŸ¥ç¡®ä¿ä»£ç è´¨é‡ï¼š

**ç¬¬ä¸€å±‚ï¼šç¡¬è§„åˆ™æ£€æŸ¥**
- TypeScript ç±»å‹æ£€æŸ¥
- ESLint ä»£ç é£æ ¼æ£€æŸ¥
- ä¾èµ–å…³ç³»éªŒè¯

**ç¬¬äºŒå±‚ï¼šLLM è¯„ä¼°**
- æœ€ä½³å®è·µç¬¦åˆåº¦
- ä»£ç å¯ç»´æŠ¤æ€§
- æ€§èƒ½ä¼˜åŒ–å»ºè®®
- é”™è¯¯å¤„ç†å®Œå–„åº¦

---

## ä½¿ç”¨æŒ‡å—

### åŸºç¡€ç”¨æ³•

#### å‘½ä»¤æ ¼å¼

```bash
pnpm run cli workflow "<è‡ªç„¶è¯­è¨€æè¿°>"
```

#### æè¿°æŠ€å·§

âœ… **å¥½çš„æè¿°**ï¼š
- "åˆ›å»ºä¸€ä¸ªç¿»è¯‘å·¥ä½œæµï¼Œæ”¯æŒä¸­è‹±äº’è¯‘ï¼Œå¸¦è´¨é‡æ£€æŸ¥å’Œé‡è¯•"
- "SEOä¼˜åŒ–å·¥ä½œæµï¼Œåˆ†ææ–‡ç« å…³é”®è¯ã€æ ‡é¢˜ä¼˜åŒ–å»ºè®®ã€å…ƒæè¿°ç”Ÿæˆ"
- "æ‰¹é‡å›¾ç‰‡ç”Ÿæˆï¼Œè¾“å…¥æ–‡æœ¬æè¿°ï¼Œç”Ÿæˆ4å¼ ä¸åŒé£æ ¼çš„å›¾ç‰‡"

âŒ **ä¸å¥½çš„æè¿°**ï¼š
- "å·¥ä½œæµ"ï¼ˆå¤ªæ¨¡ç³Šï¼‰
- "éšä¾¿å†™ç‚¹ä»€ä¹ˆ"ï¼ˆæ— æ„ä¹‰ï¼‰
- ""ï¼ˆç©ºæè¿°ï¼‰

#### ç¤ºä¾‹

**ç¤ºä¾‹ 1ï¼šç®€å•å·¥ä½œæµ**
```bash
pnpm run cli workflow "åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦"
```

**ç¤ºä¾‹ 2ï¼šå¸¦è´¨æ£€çš„å·¥ä½œæµ**
```bash
pnpm run cli workflow "æƒ…æ„Ÿåˆ†æå·¥ä½œæµï¼Œè¾“å…¥è¯„è®ºæ–‡æœ¬ï¼Œè¾“å‡ºæ­£é¢/è´Ÿé¢/ä¸­æ€§ï¼Œå¸¦è´¨é‡æ£€æŸ¥å’Œ3æ¬¡é‡è¯•"
```

**ç¤ºä¾‹ 3ï¼šå¤æ‚åˆ†æ”¯å·¥ä½œæµ**
```bash
pnpm run cli workflow "æ™ºèƒ½å®¢æœè·¯ç”±ï¼Œæ ¹æ®ç”¨æˆ·é—®é¢˜ç±»å‹ï¼ˆæŠ€æœ¯/è´¦å•/æŠ•è¯‰ï¼‰åˆ†é…åˆ°ä¸åŒå¤„ç†èŠ‚ç‚¹"
```

**ç¤ºä¾‹ 4ï¼šæ‰¹é‡å¤„ç†å·¥ä½œæµ**
```bash
pnpm run cli workflow "æ‰¹é‡æ–‡æ¡£åˆ†ç±»ï¼Œè¾“å…¥å¤šä¸ªæ–‡æ¡£è·¯å¾„ï¼Œå¹¶è¡Œåˆ†ç±»ä¸ºæŠ€æœ¯/è´¢åŠ¡/äººäº‹æ–‡æ¡£"
```

### é«˜çº§é€‰é¡¹

#### 1. ä¿å­˜è§„èŒƒæ–‡ä»¶

åªç”Ÿæˆè§„èŒƒï¼Œä¸ç”Ÿæˆä»£ç ï¼š

```bash
pnpm run cli workflow "åˆ›å»ºç¿»è¯‘å·¥ä½œæµ" --save-only
```

ç”Ÿæˆ `translation-workflow-spec.json`ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘åç”¨äºç”Ÿæˆä»£ç ã€‚

#### 2. ä»è§„èŒƒæ–‡ä»¶ç”Ÿæˆä»£ç 

```bash
pnpm run cli workflow --from-spec translation-workflow-spec.json
```

#### 3. æŒ‡å®šè¾“å‡ºç›®å½•

```bash
pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ" --output ./custom-workflows/my-workflow
```

#### 4. ç¦ç”¨å¯è§†åŒ–é¢„è§ˆ

```bash
pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ" --no-preview
```

#### 5. è·³è¿‡è´¨é‡æ£€æŸ¥

```bash
pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ" --skip-validation
```

**ä¸æ¨è**ï¼šå¯èƒ½ç”Ÿæˆä½è´¨é‡ä»£ç ã€‚

### æœ€ä½³å®è·µ

#### 1. æ˜ç¡®è¾“å…¥è¾“å‡º

âŒ æ¨¡ç³Šï¼š
```
"å¤„ç†æ–‡æœ¬çš„å·¥ä½œæµ"
```

âœ… æ¸…æ™°ï¼š
```
"åˆ›å»ºä¸€ä¸ªæ–‡æœ¬å¤„ç†å·¥ä½œæµï¼Œè¾“å…¥sourceTextå­—ç¬¦ä¸²å’ŒmaxLenæ•°å­—ï¼Œ
è¾“å‡ºprocessedTextå­—ç¬¦ä¸²å’Œç»Ÿè®¡ä¿¡æ¯statså¯¹è±¡"
```

#### 2. æŒ‡å®šèŠ‚ç‚¹ç±»å‹

æ˜ç¡®è¯´æ˜ä½¿ç”¨å“ªäº›èŠ‚ç‚¹ç±»å‹ï¼š

```
"ä½¿ç”¨LLMèŠ‚ç‚¹è¿›è¡Œç¿»è¯‘ï¼ŒAPIèŠ‚ç‚¹è°ƒç”¨å¤–éƒ¨å­—å…¸æœåŠ¡ï¼Œ
TransformèŠ‚ç‚¹è¿›è¡Œæ ¼å¼åŒ–"
```

#### 3. è¯´æ˜è´¨é‡è¦æ±‚

```
"å¸¦è´¨é‡æ£€æŸ¥ï¼Œå¦‚æœç½®ä¿¡åº¦ä½äº0.8åˆ™é‡è¯•ï¼Œæœ€å¤š3æ¬¡"
```

#### 4. æè¿°æ¡ä»¶åˆ†æ”¯

```
"å¦‚æœæ£€æµ‹åˆ°æ•æ„Ÿè¯åˆ™æ‹’ç»ï¼Œå¦‚æœè¯­è¨€ä¸æ˜¯ä¸­æ–‡åˆ™å…ˆç¿»è¯‘ï¼Œ
å¦‚æœæ–‡æœ¬è¶…è¿‡1000å­—åˆ™å…ˆæ‘˜è¦"
```

#### 5. æŒ‡å®šæ€§èƒ½è¦æ±‚

```
"è¶…æ—¶æ—¶é—´30ç§’ï¼Œæœ€å¤šé‡è¯•2æ¬¡ï¼Œä½¿ç”¨æ‰¹é‡å¤„ç†æé«˜æ•ˆç‡"
```

---

## å‘½ä»¤å‚è€ƒ

### `workflow create`

**è¯­æ³•**ï¼š
```bash
pnpm run cli workflow <æè¿°> [é€‰é¡¹]
```

**å‚æ•°**ï¼š
- `<æè¿°>`ï¼šè‡ªç„¶è¯­è¨€æè¿°ï¼ˆå¿…éœ€ï¼‰

**é€‰é¡¹**ï¼š
| é€‰é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--save-only` | åªä¿å­˜è§„èŒƒï¼Œä¸ç”Ÿæˆä»£ç  | false |
| `--from-spec <file>` | ä»è§„èŒƒæ–‡ä»¶ç”Ÿæˆä»£ç  | - |
| `--output <dir>` | è¾“å‡ºç›®å½• | ./<workflow-type> |
| `--no-preview` | ç¦ç”¨å¯è§†åŒ–é¢„è§ˆ | false |
| `--skip-validation` | è·³è¿‡è´¨é‡æ£€æŸ¥ | false |
| `--context <file>` | è‡ªå®šä¹‰ä¸Šä¸‹æ–‡æ–‡ä»¶ | - |

**ç¤ºä¾‹**ï¼š
```bash
# åŸºç¡€ç”¨æ³•
pnpm run cli workflow "åˆ›å»ºç¿»è¯‘å·¥ä½œæµ"

# åªä¿å­˜è§„èŒƒ
pnpm run cli workflow "åˆ›å»ºç¿»è¯‘å·¥ä½œæµ" --save-only

# ä»è§„èŒƒç”Ÿæˆ
pnpm run cli workflow --from-spec translation-spec.json

# è‡ªå®šä¹‰è¾“å‡º
pnpm run cli workflow "åˆ›å»ºç¿»è¯‘å·¥ä½œæµ" --output ./workflows/translator

# å®Œæ•´é€‰é¡¹
pnpm run cli workflow "åˆ›å»ºç¿»è¯‘å·¥ä½œæµ" \
  --output ./workflows \
  --context custom-context.json \
  --skip-validation
```

---

## å·¥ä½œåŸç†

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AI-Native å·¥ä½œæµè„šæ‰‹æ¶                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AI éœ€æ±‚ç†è§£  â”‚â”€â”€â”€>â”‚  å¯è§†åŒ–é¢„è§ˆ   â”‚â”€â”€â”€>â”‚  AI ä»£ç ç”Ÿæˆ  â”‚  â”‚
â”‚  â”‚   å¼•æ“       â”‚    â”‚    ç³»ç»Ÿ       â”‚    â”‚    å™¨        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                        â”‚          â”‚
â”‚         v                                        v          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å·¥ä½œæµè§„èŒƒ   â”‚                        â”‚  ç”Ÿæˆçš„ä»£ç    â”‚  â”‚
â”‚  â”‚  (JSON)      â”‚                        â”‚  (TypeScript)â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚          â”‚
â”‚                                                  v          â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                          â”‚  è´¨é‡éªŒè¯     â”‚  â”‚
â”‚                                          â”‚  + è‡ªåŠ¨ä¼˜åŒ–   â”‚  â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AI Prompt ç­–ç•¥

#### 1. éœ€æ±‚ç†è§£ Prompt

ç³»ç»Ÿ Prompt åŒ…å«ï¼š
- å·¥ä½œæµæ¶æ„æ¨¡å¼
- èŠ‚ç‚¹ç±»å‹å’Œæœ€ä½³å®è·µ
- LangGraph è¯­æ³•è§„èŒƒ
- é¡¹ç›®ä»£ç é£æ ¼ç¤ºä¾‹

ç”¨æˆ· Promptï¼š
```
ç”¨æˆ·éœ€æ±‚ï¼š{userRequest}

ç°æœ‰å·¥ä½œæµï¼š{existingWorkflows}
é¡¹ç›®æ¨¡å¼ï¼š{codePatterns}
æœ€ä½³å®è·µï¼š{bestPractices}

è¯·ç”Ÿæˆç¬¦åˆä»¥ä¸‹è¦æ±‚çš„å·¥ä½œæµè§„èŒƒï¼š
...
```

#### 2. ä»£ç ç”Ÿæˆ Prompt

é’ˆå¯¹æ¯ä¸ªä»£ç æ–‡ä»¶ï¼Œä½¿ç”¨ä¸“é—¨çš„ Promptï¼š

**çŠ¶æ€æ¥å£**ï¼š
```
ç”Ÿæˆå·¥ä½œæµçŠ¶æ€æ¥å£ï¼Œè¦æ±‚ï¼š
- ç»§æ‰¿ BaseWorkflowState
- åŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°
- åŒ…å«æ‰€æœ‰è¾“å‡ºå­—æ®µ
- æ·»åŠ  retryCount ç­‰é€šç”¨å­—æ®µ
- ä½¿ç”¨æ­£ç¡®çš„ TypeScript ç±»å‹
```

**èŠ‚ç‚¹ç±»**ï¼š
```
ç”ŸæˆèŠ‚ç‚¹ç±»ï¼Œè¦æ±‚ï¼š
- ç»§æ‰¿ BaseNode<T>
- å®ç° executeLogic æ–¹æ³•
- æ­£ç¡®å¤„ç†å¼‚æ­¥æ“ä½œ
- é€‚å½“çš„é”™è¯¯å¤„ç†
- è¿”å› Partial<State>
```

### ä»£ç ç”Ÿæˆæµç¨‹

1. **ç†è§£é˜¶æ®µ**
   - LLM åˆ†æè‡ªç„¶è¯­è¨€
   - æå–å·¥ä½œæµç±»å‹ã€èŠ‚ç‚¹ã€è¿æ¥
   - ç”Ÿæˆç»“æ„åŒ–è§„èŒƒ

2. **å¯è§†åŒ–é˜¶æ®µ**
   - ç”Ÿæˆ Mermaid æµç¨‹å›¾
   - åˆ›å»ºèŠ‚ç‚¹è¡¨æ ¼
   - ç»˜åˆ¶æ•°æ®æµå›¾
   - ç”¨æˆ·ç¡®è®¤é¢„è§ˆ

3. **ä»£ç ç”Ÿæˆé˜¶æ®µ**
   - ç”ŸæˆçŠ¶æ€æ¥å£
   - ç”ŸæˆèŠ‚ç‚¹ç±»ï¼ˆå¯å¹¶è¡Œï¼‰
   - ç”Ÿæˆè·¯ç”±å‡½æ•°
   - ç”Ÿæˆå·¥ä½œæµå›¾
   - ç”Ÿæˆå·¥å‚ç±»

4. **åå¤„ç†é˜¶æ®µ**
   - TypeScript ç±»å‹æ£€æŸ¥
   - ESLint ä»£ç æ£€æŸ¥
   - æ ¼å¼åŒ–ä»£ç 

5. **éªŒè¯é˜¶æ®µ**
   - ç¡¬è§„åˆ™æ£€æŸ¥
   - LLM è´¨é‡è¯„ä¼°
   - è‡ªåŠ¨ä¿®å¤é—®é¢˜

---

## è¿›é˜¶ä½¿ç”¨

### è‡ªå®šä¹‰é…ç½®

#### 1. é¡¹ç›®ä¸Šä¸‹æ–‡æ–‡ä»¶

åˆ›å»º `workflow-context.json`ï¼š

```json
{
  "existingWorkflows": [
    {
      "type": "content-creator",
      "category": "content",
      "tags": ["creation", "ai"]
    }
  ],
  "codePatterns": "ä½¿ç”¨ AsyncLocalStorage è¿½è¸ªè¯·æ±‚ä¸Šä¸‹æ–‡",
  "bestPractices": "æ‰€æœ‰ LLM è°ƒç”¨å¿…é¡»åŒ…å«è¶…æ—¶æ§åˆ¶",
  "commonNodes": "ä½¿ç”¨ SafeLLMNode åŒ…è£…æ‰€æœ‰ LLM èŠ‚ç‚¹"
}
```

ä½¿ç”¨ï¼š
```bash
pnpm run cli workflow "åˆ›å»ºæ–°å·¥ä½œæµ" --context workflow-context.json
```

#### 2. è‡ªå®šä¹‰ LLM æœåŠ¡

åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®ï¼š

```bash
# ä½¿ç”¨ API æ–¹å¼
LLM_SERVICE_TYPE=api
LLM_API_KEY=your-key
LLM_BASE_URL=https://api.deepseek.com
LLM_MODEL_NAME=deepseek-chat

# ä½¿ç”¨ Claude CLI
LLM_SERVICE_TYPE=cli
```

#### 3. è°ƒæ•´ç”Ÿæˆé€‰é¡¹

ä¿®æ”¹ `src/presentation/cli/scaffolding/ai/AICodeGenerator.ts`ï¼š

```typescript
const generator = new AICodeGenerator(llmService, {
  enablePostProcess: true,      // å¯ç”¨åå¤„ç†
  parallelNodes: true,          // å¹¶è¡Œç”ŸæˆèŠ‚ç‚¹
  qualityThreshold: 80,         // è´¨é‡é˜ˆå€¼
  maxRetries: 3,                // æœ€å¤§é‡è¯•æ¬¡æ•°
});
```

### æ‰©å±•åŠŸèƒ½

#### 1. æ·»åŠ è‡ªå®šä¹‰èŠ‚ç‚¹ç±»å‹

åœ¨ `schemas/WorkflowRequirementSchema.ts` ä¸­æ·»åŠ ï¼š

```typescript
const nodeTypes = ['transform', 'llm', 'api', 'quality_check', 'batch', 'custom'] as const;
```

åœ¨ Prompt ä¸­æ·»åŠ è‡ªå®šä¹‰èŠ‚ç‚¹ç±»å‹çš„è¯´æ˜ã€‚

#### 2. é›†æˆå¤–éƒ¨æœåŠ¡

åœ¨ä»£ç ç”Ÿæˆ Prompt ä¸­æ·»åŠ å¤–éƒ¨æœåŠ¡é›†æˆç¤ºä¾‹ï¼š

```typescript
// åœ¨ ai/prompts/generate-node.ts ä¸­æ·»åŠ 
examples: `
// ä½¿ç”¨ Redis ç¼“å­˜
const cached = await this.redis.get(key);
if (cached) return JSON.parse(cached);

const result = await this.llmService.chat(...);
await this.redis.set(key, JSON.stringify(result), 'EX', 3600);
`
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. å¹¶è¡Œä»£ç ç”Ÿæˆ

```typescript
const generator = new AICodeGenerator(llmService, {
  parallelNodes: true,  // å¹¶è¡Œç”ŸæˆèŠ‚ç‚¹ç±»
});
```

#### 2. ç¼“å­˜ LLM å“åº”

```bash
ENABLE_LLM_CACHE=true
CACHE_TTL=3600
```

#### 3. ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹

```bash
LLM_MODEL_NAME=deepseek-chat  # æ›´å¿«ã€æ›´ä¾¿å®œ
# æˆ–
LLM_MODEL_NAME=claude-3-haiku  # æ›´å¿«ã€æ›´ä¾¿å®œ
```

---

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. LLM è°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**ï¼š`Error: LLM service unavailable`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ API Key
echo $LLM_API_KEY

# æµ‹è¯• LLM è¿æ¥
pnpm run test:llm:quick

# åˆ‡æ¢åˆ° CLI æ¨¡å¼
LLM_SERVICE_TYPE=cli pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ"
```

#### 2. ç”Ÿæˆçš„ä»£ç æœ‰ç±»å‹é”™è¯¯

**ç—‡çŠ¶**ï¼šTypeScript ç¼–è¯‘é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ‰‹åŠ¨ä¿®å¤ç±»å‹é”™è¯¯
# æˆ–ç¦ç”¨åå¤„ç†
pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ" --skip-validation
```

#### 3. è´¨é‡æ£€æŸ¥å¤±è´¥

**ç—‡çŠ¶**ï¼šä»£ç ç”Ÿæˆåè´¨é‡è¯„åˆ†è¿‡ä½

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æä¾›æ›´è¯¦ç»†çš„æè¿°
- é™ä½è´¨é‡é˜ˆå€¼
- æ‰‹åŠ¨ä¿®å¤åé‡æ–°éªŒè¯

#### 4. å†…å­˜ä¸è¶³

**ç—‡çŠ¶**ï¼šç”Ÿæˆå¤§å·¥ä½œæµæ—¶å†…å­˜æº¢å‡º

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å¢åŠ  Node.js å†…å­˜
NODE_OPTIONS=--max-old-space-size=8192 pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ"
```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
LOG_LEVEL=debug pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ"

# ä¿å­˜ä¸­é—´ç»“æœ
SAVE_INTERMEDIATE=true pnpm run cli workflow "åˆ›å»ºå·¥ä½œæµ"
```

---

## ç¤ºä¾‹å·¥ä½œæµ

### ç¤ºä¾‹ 1ï¼šæ–‡æœ¬æ‘˜è¦

**åˆ›å»ºå‘½ä»¤**ï¼š
```bash
pnpm run cli workflow "åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦ï¼ŒåŒ…å«åŸæ–‡é•¿åº¦å’Œæ‘˜è¦é•¿åº¦ç»Ÿè®¡"
```

**ç”Ÿæˆçš„èŠ‚ç‚¹**ï¼š
- `summarize`: LLM æ‘˜è¦èŠ‚ç‚¹
- `calculateLength`: é•¿åº¦ç»Ÿè®¡èŠ‚ç‚¹

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
pnpm run cli create --type text-summarizer --sourceText "é•¿æ–‡æœ¬..." --maxLength 200
```

### ç¤ºä¾‹ 2ï¼šæƒ…æ„Ÿåˆ†æ

**åˆ›å»ºå‘½ä»¤**ï¼š
```bash
pnpm run cli workflow "æƒ…æ„Ÿåˆ†æå·¥ä½œæµï¼Œè¾“å…¥è¯„è®ºæ–‡æœ¬ï¼Œè¾“å‡ºæ­£é¢/è´Ÿé¢/ä¸­æ€§åˆ†ç±»å’Œç½®ä¿¡åº¦åˆ†æ•°"
```

**ç”Ÿæˆçš„èŠ‚ç‚¹**ï¼š
- `analyzeSentiment`: LLM æƒ…æ„Ÿåˆ†æèŠ‚ç‚¹
- `validateResult`: ç»“æœéªŒè¯èŠ‚ç‚¹

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
pnpm run cli create --type sentiment-analyzer --commentText "è¿™ä¸ªäº§å“å¾ˆæ£’ï¼" --requireHighConfidence true
```

### ç¤ºä¾‹ 3ï¼šSEO ä¼˜åŒ–

**åˆ›å»ºå‘½ä»¤**ï¼š
```bash
pnpm run cli workflow "SEOä¼˜åŒ–å·¥ä½œæµï¼Œè¾“å…¥æ–‡ç« æ ‡é¢˜å’Œå†…å®¹ï¼Œè¾“å‡ºå…³é”®è¯åˆ—è¡¨ã€æ ‡é¢˜ä¼˜åŒ–å»ºè®®ã€å…ƒæè¿°"
```

**ç”Ÿæˆçš„èŠ‚ç‚¹**ï¼š
- `extractKeywords`: å…³é”®è¯æå–èŠ‚ç‚¹
- `optimizeTitle`: æ ‡é¢˜ä¼˜åŒ–èŠ‚ç‚¹
- `generateMeta`: å…ƒæè¿°ç”ŸæˆèŠ‚ç‚¹

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
pnpm run cli create --type seo-optimizer --title "åŸæ ‡é¢˜" --content "æ–‡ç« å†…å®¹..." --keywordCount 10
```

---

## å‚è€ƒèµ„æ–™

### ç›¸å…³æ–‡æ¡£

- [LangGraph æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [é¡¹ç›®æ¶æ„æ–‡æ¡£](./architecture.md)
- [å·¥ä½œæµå¼€å‘æŒ‡å—](./workflow-development.md)

### API å‚è€ƒ

- [AINeuralUnderstandingEngine](../api/AINeuralUnderstandingEngine.md)
- [AICodeGenerator](../api/AICodeGenerator.md)
- [VisualizationPreviewSystem](../api/VisualizationPreviewSystem.md)
- [AutoValidatorOptimizer](../api/AutoValidatorOptimizer.md)

---

## åé¦ˆä¸è´¡çŒ®

### æŠ¥å‘Šé—®é¢˜

åœ¨ GitHub Issues ä¸­æŠ¥å‘Šé—®é¢˜ï¼Œè¯·åŒ…å«ï¼š
- è‡ªç„¶è¯­è¨€æè¿°
- ç”Ÿæˆçš„è§„èŒƒ
- é”™è¯¯ä¿¡æ¯
- ç¯å¢ƒä¿¡æ¯

### è´¡çŒ®ä»£ç 

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ï¼š
- [è´¡çŒ®æŒ‡å—](../CONTRIBUTING.md)
- [ä»£ç é£æ ¼](../CODE_STYLE.md)

---

**Happy Workflow Scaffolding! ğŸš€**
