# å·¥ä½œæµè„šæ‰‹æ¶å·¥å…·è®¾è®¡æ–‡æ¡£ï¼ˆAI-Nativeï¼‰

> **ç‰ˆæœ¬**: 2.0.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-04
> **æœ€åæ›´æ–°**: 2026-02-04
> **çŠ¶æ€**: è®¾è®¡é˜¶æ®µï¼Œå¾…å®æ–½
> **è®¾è®¡ç†å¿µ**: AI-Native - ä»æ¨¡æ¿å¼•æ“åˆ°æ™ºèƒ½ç”Ÿæˆçš„èŒƒå¼è½¬å˜

---

## 1. æ¦‚è¿°

### 1.1 è®¾è®¡ç†å¿µè½¬å˜

#### ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆv1.0ï¼‰çš„å±€é™

- **ç”¨æˆ·ä½“éªŒ**: éœ€è¦ 20+ ä¸ªäº¤äº’å¼é—®é¢˜ï¼Œä½“éªŒå†—é•¿
- **æŠ€æœ¯å®ç°**: åŸºäºæ¨¡æ¿å¼•æ“ï¼ˆHandlebarsï¼‰çš„ä»£ç å¡«å……
- **ä»£ç è´¨é‡**: æ¨¡æ¿åŒ–ç”Ÿæˆçš„ä»£ç ç¼ºä¹çµæ´»æ€§å’Œæœ€ä½³å®è·µ
- **å¼€å‘å‘¨æœŸ**: 14-20 å¤©çš„å…¨æµç¨‹å¼€å‘æ—¶é—´
- **ç»´æŠ¤æˆæœ¬**: éœ€è¦æŒç»­ç»´æŠ¤å’Œæ›´æ–°å¤§é‡æ¨¡æ¿æ–‡ä»¶

#### AI-Native æ–¹æ¡ˆï¼ˆv2.0ï¼‰çš„ä¼˜åŠ¿

- **ç”¨æˆ·ä½“éªŒ**: 1 å¥è¯è‡ªç„¶è¯­è¨€æè¿°ï¼ŒAI è‡ªåŠ¨ç†è§£å¹¶è®¾è®¡
- **æŠ€æœ¯å®ç°**: AI é©±åŠ¨çš„éœ€æ±‚ç†è§£ â†’ æ™ºèƒ½è®¾è®¡ â†’ ä»£ç ç”Ÿæˆ â†’ éªŒè¯ä¼˜åŒ–
- **ä»£ç è´¨é‡**: AI åŸºäºé¡¹ç›®æœ€ä½³å®è·µç”Ÿæˆé«˜è´¨é‡ä»£ç 
- **å¼€å‘å‘¨æœŸ**: 4-6 å¤©çš„å¿«é€Ÿè¿­ä»£å‘¨æœŸ
- **æ™ºèƒ½åŒ–**: æŒç»­å­¦ä¹ é¡¹ç›®æ¶æ„æ¨¡å¼ï¼Œç”Ÿæˆä»£ç è¶Šæ¥è¶Šæ™ºèƒ½

### 1.2 æ ¸å¿ƒç›®æ ‡

1. **AI éœ€æ±‚ç†è§£å¼•æ“** - ä»è‡ªç„¶è¯­è¨€æè¿°ä¸­ç²¾ç¡®æå–å·¥ä½œæµéœ€æ±‚
2. **æ™ºèƒ½å·¥ä½œæµè®¾è®¡å™¨** - åŸºäºæœ€ä½³å®è·µè‡ªåŠ¨è®¾è®¡å·¥ä½œæµç»“æ„
3. **å¯è§†åŒ–é¢„è§ˆç³»ç»Ÿ** - å®æ—¶ç”Ÿæˆ Mermaid æµç¨‹å›¾ï¼Œç›´è§‚å±•ç¤ºå·¥ä½œæµè®¾è®¡
4. **AI ä»£ç ç”Ÿæˆå™¨** - éæ¨¡æ¿å¡«å……ï¼Œè€Œæ˜¯åŸºäºç†è§£çš„æ™ºèƒ½ç”Ÿæˆ
5. **è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ–** - ç”Ÿæˆåè‡ªåŠ¨éªŒè¯ä»£ç è´¨é‡ï¼Œå¹¶æä¾›ä¼˜åŒ–å»ºè®®

### 1.3 ä½¿ç”¨ç¤ºä¾‹å¯¹æ¯”

#### ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆv1.0ï¼‰

```bash
# åˆ›å»ºæ–°å·¥ä½œæµ
pnpm run cli workflow create

# äº¤äº’å¼é—®ç­”ï¼ˆ20+ ä¸ªé—®é¢˜ï¼‰
? å·¥ä½œæµç±»å‹æ ‡è¯†ç¬¦ (å¦‚: summarizer): summarizer
? å·¥ä½œæµæ˜¾ç¤ºåç§°: æ–‡æœ¬æ‘˜è¦å·¥ä½œæµ
? å·¥ä½œæµæè¿°: åŸºäºLLMçš„æ–‡æœ¬æ‘˜è¦ç”Ÿæˆ
? å·¥ä½œæµåˆ†ç±»: content
? æ·»åŠ è¾“å…¥å‚æ•° (yes/no): yes
? å‚æ•°å: sourceText
? å‚æ•°ç±»å‹: string
? æ˜¯å¦å¿…éœ€: yes
? å‚æ•°æè¿°: å¾…æ‘˜è¦çš„æ–‡æœ¬
... (ç»§ç»­ 15+ ä¸ªé—®é¢˜)

âœ… å·¥ä½œæµä»£ç å·²ç”Ÿæˆ: src/domain/workflows/SummarizerWorkflow.ts
```

#### AI-Native æ–¹æ¡ˆï¼ˆv2.0ï¼‰

```bash
# åˆ›å»ºæ–°å·¥ä½œæµï¼ˆä¸€å¥è¯æè¿°ï¼‰
pnpm run cli workflow create "åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦ï¼ŒåŒ…å«è´¨æ£€æ­¥éª¤"

# AI ç†è§£å¹¶è®¾è®¡
ğŸ¤– AI æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚...
âœ“ éœ€æ±‚ç†è§£å®Œæˆ
  - å·¥ä½œæµç±»å‹: text-summarizer
  - è¾“å…¥å‚æ•°: sourceText (string)
  - è¾“å‡º: summarizedText (string, ~200å­—)
  - èŠ‚ç‚¹è®¾è®¡: summarize â†’ checkQuality

ğŸ“Š ç”Ÿæˆå·¥ä½œæµé¢„è§ˆ (Mermaid):
```mermaid
graph LR
    A[å¼€å§‹] --> B[æ–‡æœ¬æ‘˜è¦]
    B --> C{è´¨æ£€é€šè¿‡?}
    C -->|æ˜¯| D[ç»“æŸ]
    C -->|å¦| B
```

ğŸ¤– AI æ­£åœ¨ç”Ÿæˆä»£ç ...
âœ“ çŠ¶æ€æ¥å£ç”Ÿæˆå®Œæˆ (TranslationState.ts)
âœ“ èŠ‚ç‚¹å®ç°ç”Ÿæˆå®Œæˆ (SummarizeNode.ts, CheckQualityNode.ts)
âœ“ å·¥ä½œæµå›¾ç”Ÿæˆå®Œæˆ (SummarizerGraph.ts)
âœ“ å·¥å‚ç±»ç”Ÿæˆå®Œæˆ (SummarizerFactory.ts)
âœ“ è‡ªåŠ¨æ³¨å†Œå®Œæˆ

âœ… å·¥ä½œæµåˆ›å»ºæˆåŠŸï¼
ğŸ“ æ–‡ä»¶ä½ç½®: src/domain/workflows/TextSummarizerWorkflow.ts
ğŸš€ ç«‹å³ä½¿ç”¨: pnpm run cli create --type text-summarizer --sourceText "..."
ğŸ“– æŸ¥çœ‹æ–‡æ¡£: pnpm run cli workflow info text-summarizer
```

---

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLI å…¥å£å±‚                                    â”‚
â”‚  pnpm run cli workflow create "<è‡ªç„¶è¯­è¨€æè¿°>"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI éœ€æ±‚ç†è§£å¼•æ“ï¼ˆæ ¸å¿ƒï¼‰                              â”‚
â”‚  - LLM è§£æè‡ªç„¶è¯­è¨€æè¿°                                          â”‚
â”‚  - æå–å·¥ä½œæµå…ƒæ•°æ®ã€å‚æ•°ã€èŠ‚ç‚¹ã€æµç¨‹                            â”‚
â”‚  - ç”Ÿæˆç»“æ„åŒ–éœ€æ±‚è§„èŒƒ (JSON Schema)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ™ºèƒ½å·¥ä½œæµè®¾è®¡å™¨ï¼ˆAI-Drivenï¼‰                           â”‚
â”‚  - åŸºäºé¡¹ç›®æœ€ä½³å®è·µè®¾è®¡èŠ‚ç‚¹ç»“æ„                                  â”‚
â”‚  - æ™ºèƒ½æ¨èèŠ‚ç‚¹ç±»å‹å’Œè¿æ¥å…³ç³»                                    â”‚
â”‚  - è‡ªåŠ¨è®¾è®¡çŠ¶æ€æ¥å£ã€è·¯ç”±é€»è¾‘                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯è§†åŒ–é¢„è§ˆ   â”‚ â”‚ AI ä»£ç   â”‚ â”‚ è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ–   â”‚
â”‚              â”‚ â”‚ ç”Ÿæˆå™¨   â”‚ â”‚                  â”‚
â”‚ - Mermaid å›¾ â”‚ â”‚ - æ™ºèƒ½   â”‚ â”‚ - ä»£ç è´¨é‡æ£€æŸ¥  â”‚
â”‚ - èŠ‚ç‚¹å…³ç³»   â”‚ â”‚ ç”Ÿæˆ     â”‚ â”‚ - ç±»å‹éªŒè¯      â”‚
â”‚ - æ•°æ®æµ     â”‚ â”‚ - éæ¨¡æ¿ â”‚ â”‚ - æœ€ä½³å®è·µéªŒè¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è‡ªåŠ¨æ³¨å†Œ                                    â”‚
â”‚  - ç”Ÿæˆæ–‡ä»¶å†™å…¥                                                 â”‚
â”‚  - WorkflowRegistry æ³¨å†Œ                                        â”‚
â”‚  - CLI å‚æ•°æ˜ å°„æ›´æ–°                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒæ¨¡å—

#### 2.2.1 AI éœ€æ±‚ç†è§£å¼•æ“ï¼ˆAINeuralUnderstandingEngineï¼‰

**æ–‡ä»¶ä½ç½®**: `src/presentation/cli/scaffolding/ai/AINeuralUnderstandingEngine.ts`

```typescript
interface WorkflowRequirement {
  // åŸºæœ¬ä¿¡æ¯
  type: string;                    // AI æ¨æ–­çš„å·¥ä½œæµç±»å‹
  name: string;                    // AI ç”Ÿæˆçš„æ˜¾ç¤ºåç§°
  description: string;             // AI ç”Ÿæˆçš„æè¿°
  category: string;                // AI æ¨æ–­çš„åˆ†ç±»
  tags: string[];                  // AI æ¨æ–­çš„æ ‡ç­¾

  // å‚æ•°å®šä¹‰
  inputParams: ParamDefinition[];  // AI æå–çš„è¾“å…¥å‚æ•°
  outputFields: string[];          // AI æ¨æ–­çš„è¾“å‡ºå­—æ®µ

  // èŠ‚ç‚¹è®¾è®¡
  nodes: NodeDesign[];             // AI è®¾è®¡çš„èŠ‚ç‚¹åˆ—è¡¨
  nodeConnections: Connection[];   // AI è®¾è®¡çš„èŠ‚ç‚¹è¿æ¥å…³ç³»

  // å·¥ä½œæµé…ç½®
  enableQualityCheck: boolean;     // AI æ¨æ–­æ˜¯å¦éœ€è¦è´¨æ£€
  maxRetries: number;              // AI æ¨æ–­çš„é‡è¯•æ¬¡æ•°
  enableCheckpoint: boolean;       // AI æ¨æ–­æ˜¯å¦éœ€è¦æ£€æŸ¥ç‚¹
}

interface NodeDesign {
  name: string;                    // èŠ‚ç‚¹åç§°
  displayName: string;             // æ˜¾ç¤ºåç§°
  description: string;             // èŠ‚ç‚¹åŠŸèƒ½æè¿°
  nodeType: NodeType;              // AI æ¨æ–­çš„èŠ‚ç‚¹ç±»å‹
  timeout: number;                 // AI æ¨æ–­çš„è¶…æ—¶æ—¶é—´
  useLLM: boolean;                 // AI æ¨æ–­æ˜¯å¦ä½¿ç”¨ LLM
  llmSystemPrompt?: string;        // AI ç”Ÿæˆçš„ LLM ç³»ç»Ÿæç¤ºè¯
  enableQualityCheck: boolean;     // AI æ¨æ–­æ˜¯å¦å¯ç”¨è´¨æ£€
  qualityCheckPrompt?: string;     // AI ç”Ÿæˆçš„è´¨æ£€æç¤ºè¯
  dependencies: string[];          // ä¾èµ–çš„å‰ç½®èŠ‚ç‚¹
}

interface AINeuralUnderstandingEngine {
  /**
   * ä»è‡ªç„¶è¯­è¨€æè¿°ç†è§£å·¥ä½œæµéœ€æ±‚
   *
   * @param naturalLanguageDescription - è‡ªç„¶è¯­è¨€æè¿°
   * @param context - é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆç°æœ‰å·¥ä½œæµã€ä»£ç æ¨¡å¼ç­‰ï¼‰
   * @returns ç»“æ„åŒ–éœ€æ±‚è§„èŒƒ
   */
  understandRequirement(
    naturalLanguageDescription: string,
    context?: ProjectContext
  ): Promise<WorkflowRequirement>;

  /**
   * éªŒè¯éœ€æ±‚å®Œæ•´æ€§å’Œåˆç†æ€§
   *
   * @param requirement - éœ€æ±‚è§„èŒƒ
   * @returns éªŒè¯ç»“æœå’Œæ”¹è¿›å»ºè®®
   */
  validateRequirement(
    requirement: WorkflowRequirement
  ): Promise<ValidationResult>;

  /**
   * ä¼˜åŒ–éœ€æ±‚è®¾è®¡ï¼ˆåŸºäºæœ€ä½³å®è·µï¼‰
   *
   * @param requirement - åŸå§‹éœ€æ±‚
   * @returns ä¼˜åŒ–åçš„éœ€æ±‚
   */
  optimizeRequirement(
    requirement: WorkflowRequirement
  ): Promise<WorkflowRequirement>;
}
```

#### 2.2.2 æ™ºèƒ½å·¥ä½œæµè®¾è®¡å™¨ï¼ˆAIWorkflowDesignerï¼‰

**æ–‡ä»¶ä½ç½®**: `src/presentation/cli/scaffolding/ai/AIWorkflowDesigner.ts`

```typescript
interface AIWorkflowDesigner {
  /**
   * è®¾è®¡çŠ¶æ€æ¥å£
   *
   * @param requirement - éœ€æ±‚è§„èŒƒ
   * @returns çŠ¶æ€æ¥å£ TypeScript ä»£ç 
   */
  designStateInterface(requirement: WorkflowRequirement): Promise<string>;

  /**
   * è®¾è®¡èŠ‚ç‚¹ç±»
   *
   * @param nodeDesign - èŠ‚ç‚¹è®¾è®¡
   * @param projectPatterns - é¡¹ç›®ä¸­çš„èŠ‚ç‚¹å®ç°æ¨¡å¼
   * @returns èŠ‚ç‚¹ç±» TypeScript ä»£ç 
   */
  designNodeClass(
    nodeDesign: NodeDesign,
    projectPatterns?: ProjectPatterns
  ): Promise<string>;

  /**
   * è®¾è®¡è·¯ç”±å‡½æ•°
   *
   * @param nodes - èŠ‚ç‚¹åˆ—è¡¨
   * @param connections - èŠ‚ç‚¹è¿æ¥å…³ç³»
   * @returns è·¯ç”±å‡½æ•° TypeScript ä»£ç 
   */
  designRouteFunctions(
    nodes: NodeDesign[],
    connections: Connection[]
  ): Promise<string>;

  /**
   * è®¾è®¡å·¥ä½œæµå›¾
   *
   * @param requirement - éœ€æ±‚è§„èŒƒ
   * @param stateInterface - çŠ¶æ€æ¥å£ä»£ç 
   * @param nodes - èŠ‚ç‚¹ä»£ç 
   * @param routeFunctions - è·¯ç”±å‡½æ•°ä»£ç 
   * @returns å·¥ä½œæµå›¾ TypeScript ä»£ç 
   */
  designWorkflowGraph(
    requirement: WorkflowRequirement,
    stateInterface: string,
    nodes: string[],
    routeFunctions: string
  ): Promise<string>;

  /**
   * è®¾è®¡å·¥å‚ç±»
   *
   * @param requirement - éœ€æ±‚è§„èŒƒ
   * @param workflowGraph - å·¥ä½œæµå›¾ä»£ç 
   * @returns å·¥å‚ç±» TypeScript ä»£ç 
   */
  designFactoryClass(
    requirement: WorkflowRequirement,
    workflowGraph: string
  ): Promise<string>;
}
```

#### 2.2.3 å¯è§†åŒ–é¢„è§ˆç³»ç»Ÿï¼ˆVisualizationPreviewSystemï¼‰

**æ–‡ä»¶ä½ç½®**: `src/presentation/cli/scaffolding/visualization/VisualizationPreviewSystem.ts`

```typescript
interface VisualizationPreviewSystem {
  /**
   * ç”Ÿæˆ Mermaid æµç¨‹å›¾
   *
   * @param requirement - éœ€æ±‚è§„èŒƒ
   * @returns Mermaid å›¾è¡¨ä»£ç 
   */
  generateMermaidDiagram(requirement: WorkflowRequirement): string;

  /**
   * ç”ŸæˆèŠ‚ç‚¹å…³ç³»è¡¨
   *
   * @param nodes - èŠ‚ç‚¹åˆ—è¡¨
   * @param connections - è¿æ¥å…³ç³»
   * @returns ASCII è¡¨æ ¼
   */
  generateNodeTable(nodes: NodeDesign[], connections: Connection[]): string;

  /**
   * ç”Ÿæˆæ•°æ®æµå›¾
   *
   * @param inputParams - è¾“å…¥å‚æ•°
   * @param nodes - èŠ‚ç‚¹åˆ—è¡¨
   * @param outputFields - è¾“å‡ºå­—æ®µ
   * @returns æ•°æ®æµå›¾ï¼ˆASCIIï¼‰
   */
  generateDataFlowDiagram(
    inputParams: ParamDefinition[],
    nodes: NodeDesign[],
    outputFields: string[]
  ): string;

  /**
   * åœ¨ç»ˆç«¯æ˜¾ç¤ºé¢„è§ˆ
   *
   * @param requirement - éœ€æ±‚è§„èŒƒ
   */
  displayPreview(requirement: WorkflowRequirement): Promise<void>;
}
```

#### 2.2.4 AI ä»£ç ç”Ÿæˆå™¨ï¼ˆAICodeGeneratorï¼‰

**æ–‡ä»¶ä½ç½®**: `src/presentation/cli/scaffolding/ai/AICodeGenerator.ts`

```typescript
interface AICodeGenerator {
  /**
   * ç”Ÿæˆå®Œæ•´å·¥ä½œæµä»£ç 
   *
   * @param requirement - ä¼˜åŒ–åçš„éœ€æ±‚è§„èŒƒ
   * @param projectContext - é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆç°æœ‰ä»£ç æ¨¡å¼ã€æœ€ä½³å®è·µï¼‰
   * @returns ç”Ÿæˆçš„æ–‡ä»¶é›†åˆ
   */
  generateWorkflow(
    requirement: WorkflowRequirement,
    projectContext: ProjectContext
  ): Promise<WorkflowFiles>;

  /**
   * ç”Ÿæˆå•ä¸ªæ–‡ä»¶ä»£ç 
   *
   * @param fileType - æ–‡ä»¶ç±»å‹ï¼ˆstate | node | graph | factoryï¼‰
   * @param requirement - éœ€æ±‚è§„èŒƒ
   * @param projectPatterns - é¡¹ç›®ä»£ç æ¨¡å¼
   * @returns ç”Ÿæˆçš„ä»£ç 
   */
  generateFile(
    fileType: 'state' | 'node' | 'graph' | 'factory',
    requirement: WorkflowRequirement,
    projectPatterns?: ProjectPatterns
  ): Promise<string>;
}

interface WorkflowFiles {
  state: string;                   // çŠ¶æ€æ¥å£ä»£ç 
  nodes: Map<string, string>;      // èŠ‚ç‚¹ä»£ç ï¼ˆèŠ‚ç‚¹å -> ä»£ç ï¼‰
  graph: string;                   // å·¥ä½œæµå›¾ä»£ç 
  factory: string;                 // å·¥å‚ç±»ä»£ç 
  index: string;                   // å¯¼å‡ºæ–‡ä»¶ä»£ç 
}

interface ProjectPatterns {
  // ä»é¡¹ç›®ä¸­æå–çš„ä»£ç æ¨¡å¼
  stateInterfacePatterns: string[];   // çŠ¶æ€æ¥å£æ¨¡å¼
  nodeClassPatterns: string[];        // èŠ‚ç‚¹ç±»æ¨¡å¼
  graphPatterns: string[];            // å·¥ä½œæµå›¾æ¨¡å¼
  factoryPatterns: string[];          // å·¥å‚ç±»æ¨¡å¼
}
```

#### 2.2.5 è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ–å™¨ï¼ˆAutoValidatorOptimizerï¼‰

**æ–‡ä»¶ä½ç½®**: `src/presentation/cli/scaffolding/validation/AutoValidatorOptimizer.ts`

```typescript
interface AutoValidatorOptimizer {
  /**
   * éªŒè¯ç”Ÿæˆçš„ä»£ç è´¨é‡
   *
   * @param files - ç”Ÿæˆçš„æ–‡ä»¶
   * @returns éªŒè¯ç»“æœï¼ˆé—®é¢˜åˆ—è¡¨ã€å»ºè®®ï¼‰
   */
  validateCode(files: WorkflowFiles): Promise<CodeValidationResult>;

  /**
   * TypeScript ç±»å‹æ£€æŸ¥
   *
   * @param code - TypeScript ä»£ç 
   * @returns ç±»å‹æ£€æŸ¥ç»“æœ
   */
  checkTypeScript(code: string): Promise<TypeCheckResult>;

  /**
   * æœ€ä½³å®è·µéªŒè¯
   *
   * @param code - TypeScript ä»£ç 
   * @param projectPatterns - é¡¹ç›®æœ€ä½³å®è·µæ¨¡å¼
   * @returns æœ€ä½³å®è·µæ£€æŸ¥ç»“æœ
   */
  checkBestPractices(
    code: string,
    projectPatterns: ProjectPatterns
  ): Promise<BestPracticeResult>;

  /**
   * ä¼˜åŒ–ä»£ç ï¼ˆåŸºäº AIï¼‰
   *
   * @param code - åŸå§‹ä»£ç 
   * @param issues - å‘ç°çš„é—®é¢˜
   * @returns ä¼˜åŒ–åçš„ä»£ç 
   */
  optimizeCode(code: string, issues: CodeIssue[]): Promise<string>;
}

interface CodeValidationResult {
  valid: boolean;
  errors: CodeIssue[];
  warnings: CodeIssue[];
  suggestions: CodeSuggestion[];
  overallScore: number;  // 0-100
}

interface CodeIssue {
  severity: 'error' | 'warning' | 'info';
  category: 'syntax' | 'type' | 'best-practice' | 'performance' | 'security';
  message: string;
  line?: number;
  column?: number;
  fix?: string;  // AI ç”Ÿæˆçš„ä¿®å¤å»ºè®®
}

interface CodeSuggestion {
  category: 'optimization' | 'readability' | 'maintainability' | 'extensibility';
  message: string;
  improvedCode?: string;
  reason: string;
}
```

---

## 3. AI éœ€æ±‚ç†è§£å¼•æ“è®¾è®¡

### 3.1 å·¥ä½œåŸç†

```
è‡ªç„¶è¯­è¨€æè¿°
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM Prompt Engineering             â”‚
â”‚  - åˆ†æé¡¹ç›®æ¶æ„æ–‡æ¡£                 â”‚
â”‚  - åˆ†æç°æœ‰å·¥ä½œæµæ¨¡å¼               â”‚
â”‚  - æ„å»ºç»“æ„åŒ–æå– Prompt             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM è°ƒç”¨ï¼ˆDeepSeek/Claudeï¼‰        â”‚
â”‚  - è¾“å…¥ï¼šè‡ªç„¶è¯­è¨€ + ä¸Šä¸‹æ–‡          â”‚
â”‚  - è¾“å‡ºï¼šç»“æ„åŒ– JSON                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»“æ„åŒ–æå–ä¸éªŒè¯                   â”‚
â”‚  - JSON Schema éªŒè¯                 â”‚
â”‚  - å®Œæ•´æ€§æ£€æŸ¥                       â”‚
â”‚  - åˆç†æ€§éªŒè¯                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
         WorkflowRequirement
```

### 3.2 Prompt æ¨¡æ¿è®¾è®¡

```typescript
const WORKFLOW_UNDERSTANDING_PROMPT = `
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„å·¥ä½œæµæ¶æ„ä¸“å®¶ã€‚è¯·æ ¹æ®ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æè¿°ï¼Œåˆ†æå¹¶è®¾è®¡ä¸€ä¸ª LangGraph å·¥ä½œæµã€‚

# é¡¹ç›®ä¸Šä¸‹æ–‡

## å·¥ä½œæµç³»ç»Ÿæ¶æ„
- åŸºäº LangGraph çš„çŠ¶æ€æœºå·¥ä½œæµ
- æ‰€æœ‰èŠ‚ç‚¹ç»§æ‰¿è‡ª BaseNode<TState>
- çŠ¶æ€æ¥å£ç»§æ‰¿è‡ª BaseWorkflowState
- å·¥ä½œæµå¿…é¡»å®ç° WorkflowFactory æ¥å£

## ç°æœ‰å·¥ä½œæµç¤ºä¾‹
{EXISTING_WORKFLOWS}

## é¡¹ç›®ä»£ç æ¨¡å¼
{PROJECT_PATTERNS}

# ä»»åŠ¡è¦æ±‚

è¯·åˆ†æç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æè¿°ï¼Œæå–ä»¥ä¸‹ä¿¡æ¯å¹¶ä»¥ JSON æ ¼å¼è¿”å›ï¼š

## åŸºæœ¬ä¿¡æ¯
- type: å·¥ä½œæµç±»å‹æ ‡è¯†ç¬¦ï¼ˆkebab-caseï¼Œå¦‚: text-summarizerï¼‰
- name: å·¥ä½œæµæ˜¾ç¤ºåç§°ï¼ˆä¸­æ–‡ï¼Œç®€æ´æ˜äº†ï¼‰
- description: å·¥ä½œæµæè¿°ï¼ˆ1-2å¥è¯ï¼Œè¯´æ˜åŠŸèƒ½å’Œç”¨é€”ï¼‰
- category: å·¥ä½œæµåˆ†ç±»ï¼ˆcontent | translation | analysis | automation | otherï¼‰
- tags: æ ‡ç­¾æ•°ç»„ï¼ˆllm | quality-check | batch | real-time | multi-stepï¼‰

## è¾“å…¥å‚æ•°
æ ¹æ®æè¿°æå–æ‰€éœ€çš„è¾“å…¥å‚æ•°ï¼š
- name: å‚æ•°åï¼ˆcamelCaseï¼‰
- type: å‚æ•°ç±»å‹ï¼ˆstring | number | boolean | array | objectï¼‰
- required: æ˜¯å¦å¿…éœ€
- description: å‚æ•°æè¿°
- examples: ç¤ºä¾‹å€¼æ•°ç»„

## èŠ‚ç‚¹è®¾è®¡
æ ¹æ®åŠŸèƒ½éœ€æ±‚è®¾è®¡èŠ‚ç‚¹ï¼š
- name: èŠ‚ç‚¹åç§°ï¼ˆcamelCaseï¼Œå¦‚: summarizeï¼‰
- displayName: æ˜¾ç¤ºåç§°ï¼ˆä¸­æ–‡ï¼Œå¦‚: æ–‡æœ¬æ‘˜è¦ï¼‰
- description: èŠ‚ç‚¹åŠŸèƒ½æè¿°
- nodeType: èŠ‚ç‚¹ç±»å‹ï¼ˆllm | api | transform | quality_check | customï¼‰
- timeout: è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼Œæ ¹æ®å¤æ‚åº¦æ¨æ–­ï¼‰
- useLLM: æ˜¯å¦ä½¿ç”¨ LLMï¼ˆæ ¹æ® nodeType æ¨æ–­ï¼‰
- enableQualityCheck: æ˜¯å¦éœ€è¦è´¨æ£€ï¼ˆæ ¹æ®éœ€æ±‚æ¨æ–­ï¼‰
- dependencies: ä¾èµ–çš„å‰ç½®èŠ‚ç‚¹ï¼ˆæ•°ç»„ï¼‰

## èŠ‚ç‚¹è¿æ¥å…³ç³»
è®¾è®¡èŠ‚ç‚¹é—´çš„æ‰§è¡Œé¡ºåºå’Œæ¡ä»¶åˆ†æ”¯ï¼š
- from: æºèŠ‚ç‚¹
- to: ç›®æ ‡èŠ‚ç‚¹
- condition: æ¡ä»¶ï¼ˆå¯é€‰ï¼Œå¦‚: "passed === true"ï¼‰

## å·¥ä½œæµé…ç½®
- enableQualityCheck: æ˜¯å¦å…¨å±€å¯ç”¨è´¨æ£€
- maxRetries: æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤ 3ï¼‰
- enableCheckpoint: æ˜¯å¦å¯ç”¨æ£€æŸ¥ç‚¹ï¼ˆé»˜è®¤ trueï¼‰

# ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æè¿°

{USER_DESCRIPTION}

# è¾“å‡ºè¦æ±‚

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ JSON Schema è¿”å›ç»“æœï¼š

\`\`\`json
{
  "type": "string",
  "name": "string",
  "description": "string",
  "category": "string",
  "tags": ["string"],
  "inputParams": [
    {
      "name": "string",
      "type": "string",
      "required": boolean,
      "description": "string",
      "examples": ["string"]
    }
  ],
  "nodes": [
    {
      "name": "string",
      "displayName": "string",
      "description": "string",
      "nodeType": "string",
      "timeout": number,
      "useLLM": boolean,
      "enableQualityCheck": boolean,
      "dependencies": ["string"]
    }
  ],
  "connections": [
    {
      "from": "string",
      "to": "string",
      "condition": "string (optional)"
    }
  ],
  "enableQualityCheck": boolean,
  "maxRetries": number,
  "enableCheckpoint": boolean
}
\`\`\`

# æ³¨æ„äº‹é¡¹

1. type å¿…é¡»æ˜¯ kebab-caseï¼ˆå°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦ï¼‰
2. èŠ‚ç‚¹åç§°å¿…é¡»æ˜¯ camelCase
3. èŠ‚ç‚¹æ‰§è¡Œé¡ºåºå¿…é¡»åˆç†ï¼ˆæœ‰ä¾èµ–å…³ç³»çš„èŠ‚ç‚¹æŒ‰ä¾èµ–æ’åºï¼‰
4. å¦‚æœæ¶‰åŠ LLM ç”Ÿæˆå†…å®¹ï¼Œå»ºè®®æ·»åŠ è´¨æ£€èŠ‚ç‚¹
5. å¦‚æœæè¿°ä¸­æåˆ°"é‡è¯•"ã€"å¤±è´¥"ç­‰è¯ï¼Œåº”è®¾è®¡æ¡ä»¶åˆ†æ”¯
6. ç¡®ä¿æ‰€æœ‰å¿…éœ€å­—æ®µéƒ½æœ‰å€¼
7. ç¤ºä¾‹å€¼è¦çœŸå®å¯ç”¨

ç°åœ¨è¯·åˆ†æç”¨æˆ·çš„æè¿°å¹¶è¿”å› JSON ç»“æœã€‚
`;
```

### 3.3 ä¸Šä¸‹æ–‡æ„å»º

```typescript
interface ProjectContext {
  existingWorkflows: WorkflowMetadata[];  // ç°æœ‰å·¥ä½œæµåˆ—è¡¨
  codePatterns: ProjectPatterns;          // é¡¹ç›®ä»£ç æ¨¡å¼
  bestPractices: string[];                // æœ€ä½³å®è·µåˆ—è¡¨
  commonNodes: string[];                  // å¸¸ç”¨èŠ‚ç‚¹ç±»å‹
}

async function buildProjectContext(): Promise<ProjectContext> {
  // 1. è·å–ç°æœ‰å·¥ä½œæµ
  const existingWorkflows = WorkflowRegistry.listWorkflows();

  // 2. æå–ä»£ç æ¨¡å¼
  const codePatterns = await extractCodePatterns();

  // 3. æå–æœ€ä½³å®è·µ
  const bestPractices = await extractBestPractices();

  // 4. è¯†åˆ«å¸¸ç”¨èŠ‚ç‚¹
  const commonNodes = identifyCommonNodes(existingWorkflows);

  return {
    existingWorkflows,
    codePatterns,
    bestPractices,
    commonNodes,
  };
}

async function extractCodePatterns(): Promise<ProjectPatterns> {
  // æ‰«æç°æœ‰å·¥ä½œæµæ–‡ä»¶ï¼Œæå–ä»£ç æ¨¡å¼
  const workflowFiles = await glob('src/domain/workflow/**/*.ts');

  const patterns: ProjectPatterns = {
    stateInterfacePatterns: [],
    nodeClassPatterns: [],
    graphPatterns: [],
    factoryPatterns: [],
  };

  for (const file of workflowFiles) {
    const content = await fs.readFile(file, 'utf-8');

    // æå–çŠ¶æ€æ¥å£æ¨¡å¼
    if (content.includes('extends BaseWorkflowState')) {
      patterns.stateInterfacePatterns.push(content);
    }

    // æå–èŠ‚ç‚¹ç±»æ¨¡å¼
    if (content.includes('extends BaseNode')) {
      patterns.nodeClassPatterns.push(content);
    }

    // æå–å·¥ä½œæµå›¾æ¨¡å¼
    if (content.includes('StateGraph') && content.includes('createGraph')) {
      patterns.graphPatterns.push(content);
    }

    // æå–å·¥å‚ç±»æ¨¡å¼
    if (content.includes('implements WorkflowFactory')) {
      patterns.factoryPatterns.push(content);
    }
  }

  return patterns;
}
```

### 3.4 Few-Shot Learning ç¤ºä¾‹

```typescript
const FEW_SHOT_EXAMPLES = [
  {
    description: 'åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦ï¼ŒåŒ…å«è´¨æ£€æ­¥éª¤',
    expectedOutput: {
      type: 'text-summarizer',
      name: 'æ–‡æœ¬æ‘˜è¦å·¥ä½œæµ',
      description: 'åŸºäº LLM çš„æ™ºèƒ½æ–‡æœ¬æ‘˜è¦ç”Ÿæˆå·¥ä½œæµ',
      category: 'content',
      tags: ['llm', 'quality-check', 'content'],
      inputParams: [
        {
          name: 'sourceText',
          type: 'string',
          required: true,
          description: 'å¾…æ‘˜è¦çš„é•¿æ–‡æœ¬',
          examples: ['è¿™æ˜¯ä¸€ç¯‡å¾ˆé•¿çš„æ–‡ç« å†…å®¹...'],
        },
        {
          name: 'maxLength',
          type: 'number',
          required: false,
          description: 'æ‘˜è¦æœ€å¤§é•¿åº¦',
          examples: [200, 300],
        },
      ],
      nodes: [
        {
          name: 'summarize',
          displayName: 'æ–‡æœ¬æ‘˜è¦',
          description: 'ä½¿ç”¨ LLM ç”Ÿæˆæ–‡æœ¬æ‘˜è¦',
          nodeType: 'llm',
          timeout: 120000,
          useLLM: true,
          enableQualityCheck: false,
          dependencies: [],
        },
        {
          name: 'checkQuality',
          displayName: 'è´¨æ£€',
          description: 'æ£€æŸ¥æ‘˜è¦è´¨é‡',
          nodeType: 'quality_check',
          timeout: 60000,
          useLLM: true,
          enableQualityCheck: false,
          dependencies: ['summarize'],
        },
      ],
      connections: [
        { from: 'START', to: 'summarize' },
        { from: 'summarize', to: 'checkQuality' },
        {
          from: 'checkQuality',
          to: '__end__',
          condition: 'passed === true',
        },
        {
          from: 'checkQuality',
          to: 'summarize',
          condition: 'passed === false && retryCount < 2',
        },
      ],
      enableQualityCheck: true,
      maxRetries: 2,
      enableCheckpoint: true,
    },
  },
  // ... æ›´å¤šç¤ºä¾‹
];
```

---

## 4. å¯è§†åŒ–é¢„è§ˆç³»ç»Ÿè®¾è®¡

### 4.1 Mermaid æµç¨‹å›¾ç”Ÿæˆ

```typescript
class MermaidDiagramGenerator implements VisualizationPreviewSystem {
  generateMermaidDiagram(requirement: WorkflowRequirement): string {
    let mermaid = 'graph LR\n';
    mermaid += '    A[å¼€å§‹] -->';

    // æ·»åŠ èŠ‚ç‚¹
    const nodeMap = new Map<string, string>();
    requirement.nodes.forEach((node, index) => {
      const nodeId = String.fromCharCode(66 + index); // B, C, D, ...
      nodeMap.set(node.name, nodeId);
      mermaid += ` ${nodeId}[${node.displayName}] -->`;
    });

    mermaid = mermaid.slice(0, -3); // ç§»é™¤æœ€åçš„ "-->"
    mermaid += '\n';

    // æ·»åŠ è¿æ¥å…³ç³»
    requirement.connections.forEach((conn) => {
      const fromId = conn.from === 'START' ? 'A' : nodeMap.get(conn.from);
      const toId = conn.to === '__end__' ? 'Z[ç»“æŸ]' : nodeMap.get(conn.to);

      if (conn.condition) {
        mermaid += `    ${fromId} -->|${conn.condition}| ${toId}\n`;
      } else {
        mermaid += `    ${fromId} --> ${toId}\n`;
      }
    });

    return mermaid;
  }

  displayPreview(requirement: WorkflowRequirement): Promise<void> {
    console.log('\nğŸ“Š å·¥ä½œæµé¢„è§ˆ\n');

    // æ˜¾ç¤º Mermaid å›¾
    console.log('Mermaid æµç¨‹å›¾:');
    console.log('```mermaid');
    console.log(this.generateMermaidDiagram(requirement));
    console.log('```\n');

    // æ˜¾ç¤ºèŠ‚ç‚¹è¡¨
    console.log('èŠ‚ç‚¹åˆ—è¡¨:');
    console.log(this.generateNodeTable(requirement.nodes, requirement.connections));

    // æ˜¾ç¤ºæ•°æ®æµ
    console.log('\næ•°æ®æµ:');
    console.log(
      this.generateDataFlowDiagram(
        requirement.inputParams,
        requirement.nodes,
        requirement.outputFields
      )
    );

    return Promise.resolve();
  }
}
```

### 4.2 èŠ‚ç‚¹å…³ç³»è¡¨ç”Ÿæˆ

```typescript
generateNodeTable(nodes: NodeDesign[], connections: Connection[]): string {
  let table = '\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n';
  table += 'â”‚ èŠ‚ç‚¹åç§°    â”‚ ç±»å‹     â”‚ è¶…æ—¶æ—¶é—´   â”‚ ä¾èµ–èŠ‚ç‚¹   â”‚\n';
  table += 'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n';

  nodes.forEach((node) => {
    const name = node.displayName.padEnd(11);
    const type = node.nodeType.padEnd(10);
    const timeout = `${node.timeout / 1000}s`.padEnd(12);
    const deps = node.dependencies.join(', ').padEnd(12);

    table += `â”‚ ${name} â”‚ ${type} â”‚ ${timeout} â”‚ ${deps} â”‚\n`;
  });

  table += 'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n';

  return table;
}
```

### 4.3 æ•°æ®æµå›¾ç”Ÿæˆ

```typescript
generateDataFlowDiagram(
  inputParams: ParamDefinition[],
  nodes: NodeDesign[],
  outputFields: string[]
): string {
  let diagram = '\n';

  // è¾“å…¥å‚æ•°
  diagram += 'â”Œâ”€ è¾“å…¥å‚æ•° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n';
  inputParams.forEach((param) => {
    const required = param.required ? '*' : '';
    diagram += `  â€¢ ${param.name}: ${param.type}${required}\n`;
  });

  // èŠ‚ç‚¹å¤„ç†
  diagram += '\nâ”Œâ”€ èŠ‚ç‚¹å¤„ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n';
  nodes.forEach((node) => {
    diagram += `  ${node.displayName} (${node.name})\n`;
    if (node.useLLM) {
      diagram += `    â””â”€ ä½¿ç”¨ LLM\n`;
    }
    if (node.enableQualityCheck) {
      diagram += `    â””â”€ åŒ…å«è´¨æ£€\n`;
    }
  });

  // è¾“å‡ºå­—æ®µ
  diagram += '\nâ”Œâ”€ è¾“å‡ºç»“æœ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n';
  outputFields.forEach((field) => {
    diagram += `  â€¢ ${field}\n`;
  });

  return diagram;
}
```

---

## 5. AI ä»£ç ç”Ÿæˆå™¨è®¾è®¡

### 5.1 ä»£ç ç”Ÿæˆæµç¨‹

```
WorkflowRequirement
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆä¸Šä¸‹æ–‡æ„å»º                     â”‚
â”‚  - åŠ è½½é¡¹ç›®ä»£ç æ¨¡å¼                 â”‚
â”‚  - åŠ è½½æœ€ä½³å®è·µ                     â”‚
â”‚  - åŠ è½½ç°æœ‰å·¥ä½œæµç¤ºä¾‹               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM ä»£ç ç”Ÿæˆï¼ˆåˆ†æ­¥ï¼‰               â”‚
â”‚  1. ç”ŸæˆçŠ¶æ€æ¥å£                    â”‚
â”‚  2. ç”ŸæˆèŠ‚ç‚¹ç±»ï¼ˆæ¯ä¸ªèŠ‚ç‚¹ï¼‰          â”‚
â”‚  3. ç”Ÿæˆè·¯ç”±å‡½æ•°                    â”‚
â”‚  4. ç”Ÿæˆå·¥ä½œæµå›¾                    â”‚
â”‚  5. ç”Ÿæˆå·¥å‚ç±»                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»£ç åå¤„ç†                         â”‚
â”‚  - Prettier æ ¼å¼åŒ–                  â”‚
â”‚  - ESLint æ£€æŸ¥                      â”‚
â”‚  - TypeScript ç¼–è¯‘éªŒè¯              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
         WorkflowFiles
```

### 5.2 çŠ¶æ€æ¥å£ç”Ÿæˆ Prompt

```typescript
const STATE_INTERFACE_GENERATION_PROMPT = `
ä½ æ˜¯ä¸€ä½ TypeScript ä¸“å®¶ã€‚è¯·æ ¹æ®å·¥ä½œæµéœ€æ±‚ç”ŸæˆçŠ¶æ€æ¥å£ä»£ç ã€‚

# é¡¹ç›®ä¸Šä¸‹æ–‡

## BaseWorkflowState æ¥å£
\`\`\`typescript
interface BaseWorkflowState {
  taskId: string;
  workflowType: string;
  mode: ExecutionMode;
  currentStep: string;
  retryCount: number;
  version: number;
  startTime: number;
  endTime?: number;
  error?: string;
  metadata?: any;
}
\`\`\`

## ç°æœ‰çŠ¶æ€æ¥å£ç¤ºä¾‹
{STATE_INTERFACE_EXAMPLES}

# ä»»åŠ¡è¦æ±‚

è¯·ç”Ÿæˆç¬¦åˆä»¥ä¸‹éœ€æ±‚çš„çŠ¶æ€æ¥å£ï¼š

## å·¥ä½œæµéœ€æ±‚
\`\`\`json
${JSON.stringify(requirement, null, 2)}
\`\`\`

# ç”Ÿæˆè¦æ±‚

1. æ¥å£åç§°ï¼š{StateName}ï¼ˆå¦‚: TranslationStateï¼‰
2. ç»§æ‰¿ BaseWorkflowState
3. åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
   - è¾“å…¥å‚æ•°ï¼ˆä» inputParams æå–ï¼‰
   - æµç¨‹æ•°æ®ï¼ˆä» nodes æ¨æ–­ï¼‰
   - è´¨æ£€æ•°æ®ï¼ˆå¦‚æœ enableQualityCheckï¼‰
   - æ§åˆ¶æ•°æ®ï¼ˆé‡è¯•è®¡æ•°ç­‰ï¼‰
4. æ¯ä¸ªå­—æ®µæ·»åŠ  JSDoc æ³¨é‡Š
5. éµå¾ªé¡¹ç›®ä»£ç é£æ ¼

# è¾“å‡ºæ ¼å¼

è¯·åªè¾“å‡º TypeScript ä»£ç ï¼Œä¸è¦ä»»ä½•é¢å¤–è¯´æ˜ã€‚

\`\`\`typescript
// ç”Ÿæˆçš„çŠ¶æ€æ¥å£ä»£ç 
\`\`\`
`;
```

### 5.3 èŠ‚ç‚¹ç±»ç”Ÿæˆ Prompt

```typescript
const NODE_CLASS_GENERATION_PROMPT = `
ä½ æ˜¯ä¸€ä½ TypeScript å’Œ LangGraph ä¸“å®¶ã€‚è¯·æ ¹æ®èŠ‚ç‚¹è®¾è®¡ç”ŸæˆèŠ‚ç‚¹ç±»ä»£ç ã€‚

# é¡¹ç›®ä¸Šä¸‹æ–‡

## BaseNode åŸºç±»
\`\`\`typescript
export abstract class BaseNode<TState extends BaseWorkflowState> {
  protected readonly name: string;
  protected readonly retryCount: number;
  protected readonly timeout: number;
  protected readonly logger;

  constructor(config: NodeConfig) { ... }

  protected abstract executeLogic(state: TState): Promise<Partial<TState>>;

  protected validateState(state: TState): void { ... }

  protected extractJSON(content: string): string { ... }

  toLangGraphNode(): (state: TState) => Promise<Partial<TState>> { ... }
}
\`\`\`

## ç°æœ‰èŠ‚ç‚¹ç¤ºä¾‹
{NODE_CLASS_EXAMPLES}

## çŠ¶æ€æ¥å£
\`\`\`typescript
${stateInterface}
\`\`\`

# ä»»åŠ¡è¦æ±‚

è¯·ç”Ÿæˆä»¥ä¸‹èŠ‚ç‚¹ç±»ï¼š

## èŠ‚ç‚¹è®¾è®¡
\`\`\`json
${JSON.stringify(nodeDesign, null, 2)}
\`\`\`

# ç”Ÿæˆè¦æ±‚

1. ç±»åï¼š{NodeName}ï¼ˆå¦‚: SummarizeNodeï¼‰
2. ç»§æ‰¿ BaseNode<{StateName}>
3. å®ç°ä»¥ä¸‹æ–¹æ³•ï¼š
   - executeLogic(): æ ¸å¿ƒé€»è¾‘
   - validateState(): è¾“å…¥éªŒè¯ï¼ˆå¯é€‰ï¼‰
4. å¦‚æœ useLLM = trueï¼š
   - æ·»åŠ  buildPrompt() æ–¹æ³•
   - è°ƒç”¨ enhancedLLMService.chat()
5. å¦‚æœ enableQualityCheck = trueï¼š
   - è®¾è®¡è´¨æ£€é€»è¾‘
6. æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è®°å½•
7. æ·»åŠ  JSDoc æ³¨é‡Š
8. éµå¾ªé¡¹ç›®ä»£ç é£æ ¼

# LLM æœåŠ¡è°ƒç”¨ç¤ºä¾‹

\`\`\`typescript
const result = await enhancedLLMService.chat({
  messages: [
    { role: 'system', content: 'ç³»ç»Ÿæç¤ºè¯' },
    { role: 'user', content: 'ç”¨æˆ·æç¤ºè¯' },
  ],
  taskId: state.taskId,
  stepName: this.name,
  stream: true,
});
\`\`\`

# è¾“å‡ºæ ¼å¼

è¯·åªè¾“å‡º TypeScript ä»£ç ï¼Œä¸è¦ä»»ä½•é¢å¤–è¯´æ˜ã€‚

\`\`\`typescript
// ç”Ÿæˆçš„èŠ‚ç‚¹ç±»ä»£ç 
\`\`\`
`;
```

### 5.4 å·¥ä½œæµå›¾ç”Ÿæˆ Prompt

```typescript
const WORKFLOW_GRAPH_GENERATION_PROMPT = `
ä½ æ˜¯ä¸€ä½ LangGraph ä¸“å®¶ã€‚è¯·æ ¹æ®å·¥ä½œæµéœ€æ±‚ç”Ÿæˆå·¥ä½œæµå›¾ä»£ç ã€‚

# é¡¹ç›®ä¸Šä¸‹æ–‡

## LangGraph StateGraph ç¤ºä¾‹
\`\`\`typescript
const graph = new StateGraph<StateInterface>({
  channels: {
    taskId: {
      default: () => '',
      reducer: (x?: string, y?: string) => y ?? x ?? '',
    },
    // ... å…¶ä»–å­—æ®µ
  },
});

graph.addNode('nodeName', nodeInstance);
graph.addEdge(START, 'nodeName');
graph.addConditionalEdges('nodeName', routeFunction, {
  nextNode: 'nextNode',
  __end__: END,
});

return graph.compile();
\`\`\`

## ç°æœ‰å·¥ä½œæµå›¾ç¤ºä¾‹
{WORKFLOW_GRAPH_EXAMPLES}

## çŠ¶æ€æ¥å£
\`\`\`typescript
${stateInterface}
\`\`\`

## èŠ‚ç‚¹å®ä¾‹
${nodes.map((node) => `const ${node.name}Node = new ${toPascalCase(node.name)}().toLangGraphNode();`).join('\n')}

# ä»»åŠ¡è¦æ±‚

è¯·ç”Ÿæˆå·¥ä½œæµå›¾ä»£ç ï¼š

## èŠ‚ç‚¹è¿æ¥å…³ç³»
\`\`\`json
${JSON.stringify(connections, null, 2)}
\`\`\`

# ç”Ÿæˆè¦æ±‚

1. å®šä¹‰ StateGraph çš„ channelsï¼š
   - åŸºç¡€å­—æ®µï¼ˆä» BaseWorkflowState ç»§æ‰¿ï¼‰
   - è¾“å…¥å‚æ•°ï¼ˆä» inputParamsï¼‰
   - æµç¨‹æ•°æ®ï¼ˆä» nodes æ¨æ–­ï¼‰
   - è´¨æ£€æ•°æ®ï¼ˆå¦‚æœ enableQualityCheckï¼‰
   - æ§åˆ¶æ•°æ®ï¼ˆé‡è¯•è®¡æ•°ç­‰ï¼‰
2. æ·»åŠ æ‰€æœ‰èŠ‚ç‚¹
3. è®¾ç½®å…¥å£ç‚¹ï¼ˆSTART â†’ ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰
4. æ·»åŠ è¾¹ï¼ˆaddEdge å’Œ addConditionalEdgesï¼‰
5. ç¼–è¯‘å¹¶è¿”å›

# è¾“å‡ºæ ¼å¼

è¯·åªè¾“å‡º TypeScript ä»£ç ï¼Œä¸è¦ä»»ä½•é¢å¤–è¯´æ˜ã€‚

\`\`\`typescript
// ç”Ÿæˆçš„å·¥ä½œæµå›¾ä»£ç 
\`\`\`
`;
```

---

## 6. è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ–è®¾è®¡

### 6.1 éªŒè¯æµç¨‹

```
ç”Ÿæˆçš„ä»£ç 
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TypeScript ç¼–è¯‘æ£€æŸ¥                â”‚
â”‚  - tsc --noEmit                     â”‚
â”‚  - ç±»å‹æ£€æŸ¥                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESLint ä»£ç è´¨é‡æ£€æŸ¥                â”‚
â”‚  - ä»£ç é£æ ¼                         â”‚
â”‚  - æ½œåœ¨é—®é¢˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ€ä½³å®è·µéªŒè¯ï¼ˆAIï¼‰                 â”‚
â”‚  - ä¸é¡¹ç›®æ¨¡å¼å¯¹æ¯”                   â”‚
â”‚  - æ€§èƒ½æ£€æŸ¥                         â”‚
â”‚  - å®‰å…¨æ£€æŸ¥                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è‡ªåŠ¨ä¼˜åŒ–ï¼ˆAIï¼‰                     â”‚
â”‚  - ä¿®å¤å‘ç°çš„é—®é¢˜                   â”‚
â”‚  - ä¼˜åŒ–ä»£ç ç»“æ„                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
         ä¼˜åŒ–åçš„ä»£ç 
```

### 6.2 AI éªŒè¯ Prompt

```typescript
const CODE_VALIDATION_PROMPT = `
ä½ æ˜¯ä¸€ä½ä»£ç å®¡æŸ¥ä¸“å®¶ã€‚è¯·æ£€æŸ¥ç”Ÿæˆçš„ TypeScript ä»£ç è´¨é‡ã€‚

# é¡¹ç›®ä¸Šä¸‹æ–‡

## ä»£ç è§„èŒƒ
{PROJECT_BEST_PRACTICES}

## ä»£ç æ¨¡å¼ç¤ºä¾‹
{PROJECT_PATTERNS}

# å¾…éªŒè¯ä»£ç 

\`\`\`typescript
${code}
\`\`\`

# éªŒè¯ç»´åº¦

è¯·ä»ä»¥ä¸‹ç»´åº¦æ£€æŸ¥ä»£ç ï¼š

1. **ç±»å‹å®‰å…¨**
   - TypeScript ç±»å‹æ˜¯å¦æ­£ç¡®
   - æ˜¯å¦å­˜åœ¨ any ç±»å‹æ»¥ç”¨
   - æ³›å‹ä½¿ç”¨æ˜¯å¦åˆç†

2. **ä»£ç é£æ ¼**
   - å‘½åè§„èŒƒï¼ˆcamelCase, PascalCaseï¼‰
   - ä»£ç æ ¼å¼
   - æ³¨é‡Šè´¨é‡

3. **æœ€ä½³å®è·µ**
   - æ˜¯å¦ç¬¦åˆé¡¹ç›®æ¨¡å¼
   - é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
   - æ—¥å¿—è®°å½•æ˜¯å¦å……åˆ†

4. **æ€§èƒ½**
   - æ˜¯å¦å­˜åœ¨æ€§èƒ½é—®é¢˜
   - èµ„æºä½¿ç”¨æ˜¯å¦åˆç†

5. **å¯ç»´æŠ¤æ€§**
   - ä»£ç æ˜¯å¦æ˜“äºç†è§£
   - ç»“æ„æ˜¯å¦æ¸…æ™°
   - æ˜¯å¦æ˜“äºæ‰©å±•

# è¾“å‡ºæ ¼å¼

è¯·ä»¥ JSON æ ¼å¼è¿”å›éªŒè¯ç»“æœï¼š

\`\`\`json
{
  "valid": boolean,
  "score": number,  // 0-100
  "errors": [
    {
      "severity": "error",
      "category": "type|style|best-practice|performance|security",
      "message": "é—®é¢˜æè¿°",
      "line": number,
      "fix": "ä¿®å¤å»ºè®®"
    }
  ],
  "warnings": [...],
  "suggestions": [
    {
      "category": "optimization|readability|maintainability|extensibility",
      "message": "ä¼˜åŒ–å»ºè®®",
      "improvedCode": "æ”¹è¿›åçš„ä»£ç ç‰‡æ®µ",
      "reason": "æ”¹è¿›åŸå› "
    }
  ]
}
\`\`\`

ç°åœ¨è¯·æ£€æŸ¥ä»£ç å¹¶è¿”å› JSON ç»“æœã€‚
`;
```

### 6.3 è‡ªåŠ¨ä¼˜åŒ–

```typescript
async function optimizeCode(
  code: string,
  issues: CodeIssue[]
): Promise<string> {
  if (issues.length === 0) {
    return code;
  }

  const optimizationPrompt = `
ä½ æ˜¯ä¸€ä½ä»£ç ä¼˜åŒ–ä¸“å®¶ã€‚è¯·æ ¹æ®å‘ç°çš„é—®é¢˜ä¼˜åŒ–ä»¥ä¸‹ TypeScript ä»£ç ã€‚

# åŸå§‹ä»£ç 

\`\`\`typescript
${code}
\`\`\`

# å‘ç°çš„é—®é¢˜

${issues.map((issue) => `- [${issue.severity}] ${issue.message}ï¼ˆè¡Œ ${issue.line}ï¼‰`).join('\n')}

# ä¼˜åŒ–è¦æ±‚

1. ä¿®å¤æ‰€æœ‰é”™è¯¯ï¼ˆerrorï¼‰
2. å°½å¯èƒ½ä¿®å¤è­¦å‘Šï¼ˆwarningï¼‰
3. åº”ç”¨å»ºè®®ï¼ˆsuggestionsï¼‰ä»¥æé«˜ä»£ç è´¨é‡
4. ä¿æŒåŸæœ‰åŠŸèƒ½å’Œé€»è¾‘
5. éµå¾ªé¡¹ç›®ä»£ç é£æ ¼
6. æ·»åŠ æˆ–æ”¹è¿›æ³¨é‡Š

# è¾“å‡ºæ ¼å¼

è¯·åªè¾“å‡ºä¼˜åŒ–åçš„ TypeScript ä»£ç ï¼Œä¸è¦ä»»ä½•é¢å¤–è¯´æ˜ã€‚

\`\`\`typescript
// ä¼˜åŒ–åçš„ä»£ç 
\`\`\`
`;

  const optimizedCode = await llmService.chat({
    messages: [{ role: 'user', content: optimizationPrompt }],
    stream: false,
  });

  return optimizedCode.content.trim();
}
```

---

## 7. CLI å‘½ä»¤è®¾è®¡

### 7.1 ä¸»å‘½ä»¤

```bash
# åˆ›å»ºæ–°å·¥ä½œæµï¼ˆAI-Native æ–¹å¼ï¼‰
pnpm run cli workflow create "<è‡ªç„¶è¯­è¨€æè¿°>"

# ç¤ºä¾‹ï¼š
pnpm run cli workflow create "åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦ï¼ŒåŒ…å«è´¨æ£€æ­¥éª¤"
pnpm run cli workflow create "ç¿»è¯‘å·¥ä½œæµï¼Œæ”¯æŒä¸­è‹±æ—¥äº’è¯‘ï¼Œå¸¦è´¨æ£€å’Œé‡è¯•"
pnpm run cli workflow create "æ‰¹é‡å›¾ç‰‡ç”Ÿæˆå·¥ä½œæµï¼Œè¾“å…¥æ–‡æœ¬æè¿°ï¼Œç”Ÿæˆ4å¼ ä¸åŒé£æ ¼çš„å›¾ç‰‡"

# äº¤äº’å¼ç¡®è®¤æ¨¡å¼
pnpm run cli workflow create "<æè¿°>" --interactive

# ç›´æ¥ç”Ÿæˆæ¨¡å¼ï¼ˆè·³è¿‡ç¡®è®¤ï¼‰
pnpm run cli workflow create "<æè¿°>" --yes

# ä»…ç”Ÿæˆé¢„è§ˆï¼ˆä¸å®é™…åˆ›å»ºï¼‰
pnpm run cli workflow create "<æè¿°>" --preview

# ä¿å­˜è®¾è®¡è§„èŒƒï¼ˆä¾›åç»­ä½¿ç”¨ï¼‰
pnpm run cli workflow create "<æè¿°>" --save-spec workflow-spec.json

# ä»è§„èŒƒæ–‡ä»¶åˆ›å»º
pnpm run cli workflow create --from-spec workflow-spec.json
```

### 7.2 è¾…åŠ©å‘½ä»¤

```bash
# åˆ—å‡ºæ‰€æœ‰å·¥ä½œæµ
pnpm run cli workflow list

# æŸ¥çœ‹å·¥ä½œæµè¯¦æƒ…
pnpm run cli workflow info <workflow-type>

# éªŒè¯å·¥ä½œæµ
pnpm run cli workflow validate <workflow-type>

# å¯¼å‡ºå·¥ä½œæµè§„èŒƒ
pnpm run cli workflow export <workflow-type> --output spec.json

# åˆ é™¤å·¥ä½œæµ
pnpm run cli workflow remove <workflow-type>

# æ¯”è¾ƒ AI ç”Ÿæˆ vs æ‰‹åŠ¨ç¼–å†™
pnpm run cli workflow diff <workflow-type>
```

### 7.3 å‘½ä»¤å®ç°

```typescript
import { Command } from 'commander';
import { AINeuralUnderstandingEngine } from '../ai/AINeuralUnderstandingEngine.js';
import { AIWorkflowDesigner } from '../ai/AIWorkflowDesigner.js';
import { VisualizationPreviewSystem } from '../visualization/VisualizationPreviewSystem.js';
import { AICodeGenerator } from '../ai/AICodeGenerator.js';
import { AutoValidatorOptimizer } from '../validation/AutoValidatorOptimizer.js';

export const createWorkflowCommand = new Command('create')
  .description('åˆ›å»ºæ–°çš„å·¥ä½œæµï¼ˆAI-Nativeï¼‰')
  .argument('<description>', 'è‡ªç„¶è¯­è¨€æè¿°å·¥ä½œæµéœ€æ±‚')
  .option('-i, --interactive', 'äº¤äº’å¼ç¡®è®¤æ¨¡å¼')
  .option('-y, --yes', 'è·³è¿‡æ‰€æœ‰ç¡®è®¤ï¼Œç›´æ¥ç”Ÿæˆ')
  .option('-p, --preview', 'ä»…ç”Ÿæˆé¢„è§ˆï¼Œä¸å®é™…åˆ›å»º')
  .option('--save-spec <file>', 'ä¿å­˜è®¾è®¡è§„èŒƒåˆ°æ–‡ä»¶')
  .option('--from-spec <file>', 'ä»è§„èŒƒæ–‡ä»¶åˆ›å»º')
  .action(async (description: string, options) => {
    try {
      // 1. æ„å»ºé¡¹ç›®ä¸Šä¸‹æ–‡
      const context = await buildProjectContext();

      // 2. AI ç†è§£éœ€æ±‚
      console.log('ğŸ¤– AI æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚...');
      const understandingEngine = new AINeuralUnderstandingEngine();

      let requirement: WorkflowRequirement;

      if (options.fromSpec) {
        // ä»è§„èŒƒæ–‡ä»¶åŠ è½½
        requirement = JSON.parse(await fs.readFile(options.fromSpec, 'utf-8'));
      } else {
        // AI ç†è§£è‡ªç„¶è¯­è¨€
        requirement = await understandingEngine.understandRequirement(
          description,
          context
        );
      }

      console.log('âœ“ éœ€æ±‚ç†è§£å®Œæˆ');
      console.log(`  - å·¥ä½œæµç±»å‹: ${requirement.type}`);
      console.log(`  - èŠ‚ç‚¹æ•°é‡: ${requirement.nodes.length}`);

      // 3. AI ä¼˜åŒ–è®¾è®¡
      console.log('\nğŸ¤– AI æ­£åœ¨ä¼˜åŒ–å·¥ä½œæµè®¾è®¡...');
      const designer = new AIWorkflowDesigner();
      const optimizedRequirement = await designer.optimizeRequirement(requirement);
      console.log('âœ“ è®¾è®¡ä¼˜åŒ–å®Œæˆ');

      // 4. å¯è§†åŒ–é¢„è§ˆ
      console.log('\nğŸ“Š ç”Ÿæˆå·¥ä½œæµé¢„è§ˆ...');
      const visualizer = new VisualizationPreviewSystem();
      await visualizer.displayPreview(optimizedRequirement);

      // 5. äº¤äº’å¼ç¡®è®¤
      if (options.interactive && !options.yes) {
        const confirmed = await confirm('ç¡®è®¤ç”Ÿæˆå·¥ä½œæµï¼Ÿ');
        if (!confirmed) {
          console.log('âŒ å·²å–æ¶ˆ');
          return;
        }
      }

      if (options.preview) {
        console.log('\nâœ… é¢„è§ˆæ¨¡å¼ï¼Œä¸å®é™…åˆ›å»º');
        if (options.saveSpec) {
          await fs.writeFile(
            options.saveSpec,
            JSON.stringify(optimizedRequirement, null, 2)
          );
          console.log(`ğŸ“ è§„èŒƒå·²ä¿å­˜: ${options.saveSpec}`);
        }
        return;
      }

      // 6. AI ç”Ÿæˆä»£ç 
      console.log('\nğŸ¤– AI æ­£åœ¨ç”Ÿæˆä»£ç ...');
      const codeGenerator = new AICodeGenerator();
      const files = await codeGenerator.generateWorkflow(
        optimizedRequirement,
        context
      );

      console.log('âœ“ ä»£ç ç”Ÿæˆå®Œæˆ');

      // 7. è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ–
      console.log('\nğŸ” æ­£åœ¨éªŒè¯ä»£ç è´¨é‡...');
      const validator = new AutoValidatorOptimizer();
      const validation = await validator.validateCode(files);

      console.log(`âœ“ éªŒè¯å®Œæˆï¼ˆå¾—åˆ†: ${validation.overallScore}/100ï¼‰`);

      if (validation.errors.length > 0) {
        console.log(`âš ï¸  å‘ç° ${validation.errors.length} ä¸ªé”™è¯¯ï¼Œæ­£åœ¨ä¿®å¤...`);
        // è‡ªåŠ¨ä¿®å¤
      }

      if (validation.warnings.length > 0) {
        console.log(`âš ï¸  å‘ç° ${validation.warnings.length} ä¸ªè­¦å‘Š`);
      }

      // 8. å†™å…¥æ–‡ä»¶
      console.log('\nğŸ“ æ­£åœ¨å†™å…¥æ–‡ä»¶...');
      const fileName = `${toPascalCase(optimizedRequirement.type)}Workflow.ts`;
      const filePath = path.join(workflowsDir, fileName);

      await fs.writeFile(filePath, files.index, 'utf-8');
      console.log(`âœ“ å·¥ä½œæµæ–‡ä»¶: ${filePath}`);

      // 9. è‡ªåŠ¨æ³¨å†Œ
      console.log('\nğŸ”§ æ­£åœ¨æ³¨å†Œå·¥ä½œæµ...');
      await registerWorkflow(fileName, optimizedRequirement);
      console.log('âœ“ æ³¨å†Œå®Œæˆ');

      // 10. ä¿å­˜è§„èŒƒï¼ˆå¦‚æœéœ€è¦ï¼‰
      if (options.saveSpec) {
        await fs.writeFile(
          options.saveSpec,
          JSON.stringify(optimizedRequirement, null, 2)
        );
        console.log(`ğŸ“ è§„èŒƒå·²ä¿å­˜: ${options.saveSpec}`);
      }

      // 11. å®Œæˆ
      console.log('\nâœ… å·¥ä½œæµåˆ›å»ºæˆåŠŸï¼');
      console.log(`ğŸ“ æ–‡ä»¶ä½ç½®: ${filePath}`);
      console.log(`ğŸš€ ç«‹å³ä½¿ç”¨: pnpm run cli create --type ${optimizedRequirement.type} --<å‚æ•°> <å€¼>`);
      console.log(`ğŸ“– æŸ¥çœ‹è¯¦æƒ…: pnpm run cli workflow info ${optimizedRequirement.type}`);

      if (validation.suggestions.length > 0) {
        console.log('\nğŸ’¡ ä¼˜åŒ–å»ºè®®:');
        validation.suggestions.slice(0, 3).forEach((s, i) => {
          console.log(`  ${i + 1}. ${s.message}`);
        });
      }
    } catch (error) {
      console.error('âŒ åˆ›å»ºå¤±è´¥:', error);
      process.exit(1);
    }
  });
```

---

## 8. æŠ€æœ¯æ ˆæ›´æ–°

### 8.1 æ ¸å¿ƒä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **@langchain/langgraph** | ^0.2.0 | LangGraph å·¥ä½œæµå¼•æ“ |
| **openai** | ^4.0.0 | LLM API è°ƒç”¨ï¼ˆGPT-4ï¼‰ |
| **@anthropic-ai/sdk** | ^0.20.0 | Claude API è°ƒç”¨ |
| **zod** | ^3.22.0 | Schema éªŒè¯ |
| **inquirer** | ^9.0.0 | äº¤äº’å¼ CLI |
| **chalk** | ^5.0.0 | ç»ˆç«¯è¾“å‡ºç€è‰² |
| **ora** | ^6.0.0 | åŠ è½½åŠ¨ç”» |
| **fs-extra** | ^11.0.0 | æ–‡ä»¶æ“ä½œ |
| **prettier** | ^3.0.0 | ä»£ç æ ¼å¼åŒ– |
| **eslint** | ^8.0.0 | ä»£ç è´¨é‡æ£€æŸ¥ |
| **typescript** | ^5.3.0 | TypeScript ç¼–è¯‘ |

### 8.2 AI æœåŠ¡é›†æˆ

```typescript
// src/infrastructure/ai/AIServiceFactory.ts

interface AIService {
  chat(params: ChatParams): Promise<ChatResponse>;
  streamChat(params: ChatParams): AsyncIterable<string>;
}

class AIServiceFactory {
  private static instance: AIService;

  static getInstance(): AIService {
    if (!this.instance) {
      const provider = process.env.AI_PROVIDER || 'deepseek'; // deepseek | openai | anthropic

      switch (provider) {
        case 'deepseek':
          this.instance = new DeepSeekAIService();
          break;
        case 'openai':
          this.instance = new OpenAIAIService();
          break;
        case 'anthropic':
          this.instance = new AnthropicAIService();
          break;
        default:
          throw new Error(`Unknown AI provider: ${provider}`);
      }
    }

    return this.instance;
  }
}

class DeepSeekAIService implements AIService {
  private client: OpenAI;

  constructor() {
    this.client = new OpenAI({
      apiKey: process.env.DEEPSEEK_API_KEY,
      baseURL: 'https://api.deepseek.com/v1',
    });
  }

  async chat(params: ChatParams): Promise<ChatResponse> {
    const response = await this.client.chat.completions.create({
      model: 'deepseek-chat',
      messages: params.messages,
      temperature: 0.7,
      stream: false,
    });

    return {
      content: response.choices[0].message.content || '',
      usage: {
        tokensIn: response.usage?.prompt_tokens || 0,
        tokensOut: response.usage?.completion_tokens || 0,
      },
    };
  }

  async *streamChat(params: ChatParams): AsyncIterable<string> {
    const stream = await this.client.chat.completions.create({
      model: 'deepseek-chat',
      messages: params.messages,
      temperature: 0.7,
      stream: true,
    });

    for await (const chunk of stream) {
      const content = chunk.choices[0]?.delta?.content;
      if (content) {
        yield content;
      }
    }
  }
}
```

### 8.3 Schema éªŒè¯

```typescript
// src/presentation/cli/scaffolding/schemas/WorkflowRequirementSchema.ts

import { z } from 'zod';

export const ParamDefinitionSchema = z.object({
  name: z.string().regex(/^[a-z][a-zA-Z0-9]*$/, 'Must be camelCase'),
  type: z.enum(['string', 'number', 'boolean', 'array', 'object']),
  required: z.boolean(),
  description: z.string().min(1),
  defaultValue: z.any().optional(),
  examples: z.array(z.any()).optional(),
});

export const NodeDesignSchema = z.object({
  name: z.string().regex(/^[a-z][a-zA-Z0-9]*$/, 'Must be camelCase'),
  displayName: z.string().min(1),
  description: z.string().min(1),
  nodeType: z.enum(['llm', 'api', 'transform', 'quality_check', 'custom']),
  timeout: z.number().int().positive(),
  useLLM: z.boolean(),
  llmSystemPrompt: z.string().optional(),
  enableQualityCheck: z.boolean(),
  qualityCheckPrompt: z.string().optional(),
  dependencies: z.array(z.string()),
});

export const ConnectionSchema = z.object({
  from: z.string(),
  to: z.string(),
  condition: z.string().optional(),
});

export const WorkflowRequirementSchema = z.object({
  type: z.string()
    .regex(/^[a-z][a-z0-9-]*$/, 'Must be kebab-case'),
  name: z.string().min(1),
  description: z.string().min(1),
  category: z.enum(['content', 'translation', 'analysis', 'automation', 'other']),
  tags: z.array(z.string()),
  inputParams: z.array(ParamDefinitionSchema),
  outputFields: z.array(z.string()),
  nodes: z.array(NodeDesignSchema).min(1),
  connections: z.array(ConnectionSchema).min(1),
  enableQualityCheck: z.boolean(),
  maxRetries: z.number().int().min(0).max(10),
  enableCheckpoint: z.boolean(),
});

export type WorkflowRequirement = z.infer<typeof WorkflowRequirementSchema>;
export type ParamDefinition = z.infer<typeof ParamDefinitionSchema>;
export type NodeDesign = z.infer<typeof NodeDesignSchema>;
export type Connection = z.infer<typeof ConnectionSchema>;
```

---

## 9. å®æ–½è®¡åˆ’

### 9.1 é˜¶æ®µåˆ’åˆ†ï¼ˆä¼˜åŒ–åï¼š4-6 å¤©ï¼‰

| é˜¶æ®µ | ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥ä½œé‡ | ä¾èµ– |
|------|------|--------|-----------|------|
| **é˜¶æ®µ 1** | AI éœ€æ±‚ç†è§£å¼•æ“ | é«˜ | 1-1.5 å¤© | - |
| | - Prompt Engineering | | | |
| | - ä¸Šä¸‹æ–‡æ„å»º | | | |
| | - Few-Shot Learning | | | |
| | - Schema éªŒè¯ | | | |
| **é˜¶æ®µ 2** | å¯è§†åŒ–é¢„è§ˆç³»ç»Ÿ | é«˜ | 0.5-1 å¤© | é˜¶æ®µ 1 |
| | - Mermaid å›¾ç”Ÿæˆ | | | |
| | - èŠ‚ç‚¹è¡¨ç”Ÿæˆ | | | |
| | - æ•°æ®æµå›¾ç”Ÿæˆ | | | |
| **é˜¶æ®µ 3** | AI ä»£ç ç”Ÿæˆå™¨ | é«˜ | 1.5-2 å¤© | é˜¶æ®µ 1 |
| | - ä»£ç ç”Ÿæˆ Prompt | | | |
| | - çŠ¶æ€æ¥å£ç”Ÿæˆ | | | |
| | - èŠ‚ç‚¹ç±»ç”Ÿæˆ | | | |
| | - å·¥ä½œæµå›¾ç”Ÿæˆ | | | |
| | - å·¥å‚ç±»ç”Ÿæˆ | | | |
| **é˜¶æ®µ 4** | è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ– | ä¸­ | 0.5-1 å¤© | é˜¶æ®µ 3 |
| | - TypeScript ç¼–è¯‘æ£€æŸ¥ | | | |
| | - ESLint æ£€æŸ¥ | | | |
| | - AI æœ€ä½³å®è·µéªŒè¯ | | | |
| | - è‡ªåŠ¨ä¼˜åŒ– | | | |
| **é˜¶æ®µ 5** | CLI é›†æˆ | é«˜ | 0.5 å¤© | é˜¶æ®µ 1-4 |
| | - å‘½ä»¤æ³¨å†Œ | | | |
| | - äº¤äº’æµç¨‹ | | | |
| | - é”™è¯¯å¤„ç† | | | |
| **é˜¶æ®µ 6** | æµ‹è¯•ä¸æ–‡æ¡£ | ä¸­ | 0.5-1 å¤© | æ‰€æœ‰é˜¶æ®µ |
| | - å•å…ƒæµ‹è¯• | | | |
| | - é›†æˆæµ‹è¯• | | | |
| | - ä½¿ç”¨æ–‡æ¡£ | | | |
| | - ç¤ºä¾‹å·¥ä½œæµ | | | |

**æ€»è®¡**: 4.5-7 å¤©ï¼ˆæ¯”ä¼ ç»Ÿæ–¹æ¡ˆèŠ‚çœ 60%+ æ—¶é—´ï¼‰

### 9.2 æ¯æ—¥è¯¦ç»†è®¡åˆ’

#### Day 1: AI éœ€æ±‚ç†è§£å¼•æ“ + å¯è§†åŒ–é¢„è§ˆ

- **ä¸Šåˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] è®¾è®¡ Prompt æ¨¡æ¿
  - [ ] å®ç°ä¸Šä¸‹æ–‡æ„å»ºé€»è¾‘
  - [ ] å‡†å¤‡ Few-Shot Learning ç¤ºä¾‹
  - [ ] å®ç° AINeuralUnderstandingEngine æ ¸å¿ƒ

- **ä¸‹åˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] å®ç° Schema éªŒè¯
  - [ ] å®ç°å¯è§†åŒ–é¢„è§ˆç³»ç»Ÿ
  - [ ] å•å…ƒæµ‹è¯•
  - [ ] é›†æˆæµ‹è¯•

#### Day 2: AI ä»£ç ç”Ÿæˆå™¨ï¼ˆPart 1ï¼‰

- **ä¸Šåˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] è®¾è®¡ä»£ç ç”Ÿæˆ Prompt æ¨¡æ¿
  - [ ] å®ç°çŠ¶æ€æ¥å£ç”Ÿæˆ
  - [ ] å®ç°èŠ‚ç‚¹ç±»ç”Ÿæˆ
  - [ ] å•å…ƒæµ‹è¯•

- **ä¸‹åˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] å®ç°è·¯ç”±å‡½æ•°ç”Ÿæˆ
  - [ ] å®ç°å·¥ä½œæµå›¾ç”Ÿæˆ
  - [ ] å•å…ƒæµ‹è¯•
  - [ ] ç”Ÿæˆä»£ç éªŒè¯

#### Day 3: AI ä»£ç ç”Ÿæˆå™¨ï¼ˆPart 2ï¼‰+ éªŒè¯ä¼˜åŒ–

- **ä¸Šåˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] å®ç°å·¥å‚ç±»ç”Ÿæˆ
  - [ ] å®ç°å®Œæ•´å·¥ä½œæµç”Ÿæˆ
  - [ ] ä»£ç åå¤„ç†ï¼ˆæ ¼å¼åŒ–ã€Lintï¼‰

- **ä¸‹åˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] å®ç°è‡ªåŠ¨éªŒè¯ç³»ç»Ÿ
  - [ ] å®ç° AI ä¼˜åŒ–é€»è¾‘
  - [ ] å•å…ƒæµ‹è¯•
  - [ ] ç«¯åˆ°ç«¯æµ‹è¯•

#### Day 4: CLI é›†æˆ + æµ‹è¯•

- **ä¸Šåˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] å®ç° CLI å‘½ä»¤
  - [ ] å®ç°äº¤äº’æµç¨‹
  - [ ] é”™è¯¯å¤„ç†

- **ä¸‹åˆ**ï¼ˆ4 å°æ—¶ï¼‰
  - [ ] é›†æˆæµ‹è¯•
  - [ ] ç”¨æˆ·éªŒæ”¶æµ‹è¯•
  - [ ] Bug ä¿®å¤

#### Day 5: æ–‡æ¡£ + ç¤ºä¾‹ï¼ˆå¯é€‰ï¼‰

- **å…¨å¤©**ï¼ˆ8 å°æ—¶ï¼‰
  - [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£
  - [ ] åˆ›å»ºç¤ºä¾‹å·¥ä½œæµ
  - [ ] å½•åˆ¶æ¼”ç¤ºè§†é¢‘
  - [ ] å‘å¸ƒåˆ°å›¢é˜Ÿ

### 9.3 é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | æ ‡å¿— | é¢„æœŸæ—¶é—´ |
|--------|------|---------|
| M1: AI ç†è§£éœ€æ±‚ | èƒ½ä»è‡ªç„¶è¯­è¨€ç”Ÿæˆç»“æ„åŒ–éœ€æ±‚ | Day 1 ä¸‹åˆ |
| M2: å¯è§†åŒ–é¢„è§ˆ | èƒ½æ˜¾ç¤º Mermaid æµç¨‹å›¾ | Day 1 ä¸‹åˆ |
| M3: ä»£ç ç”Ÿæˆ | èƒ½ç”Ÿæˆå®Œæ•´å·¥ä½œæµä»£ç  | Day 3 ä¸Šåˆ |
| M4: è‡ªåŠ¨éªŒè¯ | èƒ½éªŒè¯å¹¶ä¼˜åŒ–ä»£ç  | Day 3 ä¸‹åˆ |
| M5: CLI å¯ç”¨ | èƒ½é€šè¿‡å‘½ä»¤åˆ›å»ºå·¥ä½œæµ | Day 4 ä¸Šåˆ |
| M6: ç”Ÿäº§å°±ç»ª | é€šè¿‡æ‰€æœ‰æµ‹è¯•ï¼Œæ–‡æ¡£å®Œå–„ | Day 5 ç»“æŸ |

---

## 10. é£é™©ä¸æŒ‘æˆ˜

### 10.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| AI ç†è§£ä¸å‡†ç¡® | é«˜ | ä¸­ | - Few-Shot Learning<br>- å¤šè½®äº¤äº’ç¡®è®¤<br>- äººå·¥å®¡æ ¸æœºåˆ¶ |
| ç”Ÿæˆçš„ä»£ç æœ‰é”™è¯¯ | é«˜ | ä¸­ | - è‡ªåŠ¨éªŒè¯ç³»ç»Ÿ<br>- TypeScript ç¼–è¯‘æ£€æŸ¥<br>- å•å…ƒæµ‹è¯•è¦†ç›– |
| AI API æˆæœ¬ | ä¸­ | ä½ | - ç¼“å­˜å¸¸è§æ¨¡å¼<br>- ä½¿ç”¨æ›´ä¾¿å®œçš„æ¨¡å‹<br>- æ‰¹é‡å¤„ç† |
| æ€§èƒ½é—®é¢˜ | ä¸­ | ä½ | - å¼‚æ­¥å¤„ç†<br>- æµå¼ç”Ÿæˆ<br>- è¿›åº¦æ˜¾ç¤º |

### 10.2 äº§å“é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| ç”¨æˆ·æ¥å—åº¦ä½ | é«˜ | ä½ | - ä¿ç•™ä¼ ç»Ÿæ–¹æ¡ˆä½œä¸ºå¤‡é€‰<br>- æ¸è¿›å¼æ¨å‡º<br>- ç”¨æˆ·åŸ¹è®­ |
| ç”Ÿæˆè´¨é‡ä¸ç¨³å®š | é«˜ | ä¸­ | - æŒç»­ä¼˜åŒ– Prompt<br>- æ”¶é›†åé¦ˆè¿­ä»£<br>- ç‰ˆæœ¬æ§åˆ¶ |
| ç»´æŠ¤æˆæœ¬é«˜ | ä¸­ | ä½ | - æ¨¡å—åŒ–è®¾è®¡<br>- å¯é…ç½®åŒ–<br>- è‡ªåŠ¨åŒ–æµ‹è¯• |

### 10.3 ä¸šåŠ¡é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| å¼€å‘å‘¨æœŸå»¶é•¿ | ä¸­ | ä½ | - è¯¦ç»†è®¡åˆ’<br>- æ¯æ—¥ç«™ä¼š<br>- é£é™©é¢„ç•™ |
| å›¢é˜Ÿå­¦ä¹ æˆæœ¬ | ä½ | ä¸­ | - æŠ€æœ¯åˆ†äº«<br>- æ–‡æ¡£å®Œå–„<br>- ä»£ç å®¡æŸ¥ |

---

## 11. æœªæ¥æ‰©å±•

### 11.1 å¤šæ¨¡æ€è¾“å…¥

```bash
# æ”¯æŒå›¾ç‰‡è¾“å…¥ï¼ˆä»æµç¨‹å›¾ç”Ÿæˆå·¥ä½œæµï¼‰
pnpm run cli workflow create --image workflow-diagram.png

# æ”¯æŒè¯­éŸ³è¾“å…¥
pnpm run cli workflow create --voice "åˆ›å»ºä¸€ä¸ªç¿»è¯‘å·¥ä½œæµ..."

# æ”¯æŒä»£ç ç‰‡æ®µè¾“å…¥ï¼ˆä»ä¼ªä»£ç ç”Ÿæˆï¼‰
pnpm run cli workflow create --code snippet.py
```

### 11.2 æ™ºèƒ½æ¨è

```bash
# AI æ¨èæœ€ä½³å·¥ä½œæµ
pnpm run cli workflow recommend "ç¿»è¯‘æ–‡æœ¬"

# AI å»ºè®®ç°æœ‰å·¥ä½œæµä¼˜åŒ–
pnpm run cli workflow optimize content-creator

# AI åˆå¹¶å¤šä¸ªå·¥ä½œæµ
pnpm run cli workflow merge translation summarizer --name "translate-and-summarize"
```

### 11.3 åä½œåŠŸèƒ½

```bash
# åˆ†äº«å·¥ä½œæµè®¾è®¡
pnpm run cli workflow share content-creator --team

# è¯„å®¡å·¥ä½œæµï¼ˆAI + äººå·¥ï¼‰
pnpm run cli workflow review content-creator

# ç‰ˆæœ¬ç®¡ç†
pnpm run cli workflow version content-creator --tag v2.0
```

### 11.4 å·¥ä½œæµå¸‚åœº

```bash
# ä»å¸‚åœºå®‰è£…å·¥ä½œæµ
pnpm run cli workflow marketplace install sentiment-analysis

# å‘å¸ƒå·¥ä½œæµåˆ°å¸‚åœº
pnpm run cli workflow marketplace publish text-summarizer

# æœç´¢å·¥ä½œæµ
pnpm run cli workflow marketplace search "ç¿»è¯‘"
```

---

## 12. æ€§èƒ½æŒ‡æ ‡

### 12.1 å¼€å‘æ•ˆç‡æå‡

| æŒ‡æ ‡ | ä¼ ç»Ÿæ–¹æ¡ˆ | AI-Native æ–¹æ¡ˆ | æå‡ |
|------|---------|---------------|------|
| å·¥ä½œæµåˆ›å»ºæ—¶é—´ | 2-4 å°æ—¶ | 5-10 åˆ†é’Ÿ | **12-48x** |
| äº¤äº’é—®é¢˜æ•°é‡ | 20+ | 1 å¥è¯ | **20x+** |
| ä»£ç è¡Œæ•°ï¼ˆæ‰‹å·¥ç¼–å†™ï¼‰ | 500-800 è¡Œ | 0 è¡Œ | **âˆ** |
| å¼€å‘å‘¨æœŸ | 14-20 å¤© | 4-6 å¤© | **3-5x** |

### 12.2 è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹æ³• |
|------|------|---------|
| éœ€æ±‚ç†è§£å‡†ç¡®ç‡ | â‰¥ 90% | äººå·¥æ ‡æ³¨æ•°æ®é›†æµ‹è¯• |
| ä»£ç ä¸€æ¬¡ç”ŸæˆæˆåŠŸç‡ | â‰¥ 80% | è‡ªåŠ¨ç¼–è¯‘ + æµ‹è¯• |
| ä»£ç è´¨é‡å¾—åˆ† | â‰¥ 85/100 | ESLint + AI è¯„åˆ† |
| ç”¨æˆ·æ»¡æ„åº¦ | â‰¥ 4.5/5 | ç”¨æˆ·åé¦ˆè°ƒæŸ¥ |

### 12.3 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | ä¼˜åŒ–æ–¹æ³• |
|------|------|---------|
| éœ€æ±‚ç†è§£æ—¶é—´ | â‰¤ 30 ç§’ | ç¼“å­˜ + å¹¶è¡Œå¤„ç† |
| ä»£ç ç”Ÿæˆæ—¶é—´ | â‰¤ 60 ç§’ | æµå¼ç”Ÿæˆ + å¼‚æ­¥å¤„ç† |
| éªŒè¯æ—¶é—´ | â‰¤ 20 ç§’ | å¢é‡æ£€æŸ¥ |
| ç«¯åˆ°ç«¯æ—¶é—´ | â‰¤ 2 åˆ†é’Ÿ | æ•´ä½“ä¼˜åŒ– |

---

## 13. æˆåŠŸæ¡ˆä¾‹

### 13.1 æ–‡æœ¬æ‘˜è¦å·¥ä½œæµ

**ç”¨æˆ·æè¿°**:
```
åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ‘˜è¦å·¥ä½œæµï¼Œè¾“å…¥é•¿æ–‡æœ¬ï¼Œè¾“å‡º200å­—æ‘˜è¦ï¼ŒåŒ…å«è´¨æ£€æ­¥éª¤
```

**AI ç”Ÿæˆç»“æœ**:
- å·¥ä½œæµç±»å‹: `text-summarizer`
- èŠ‚ç‚¹è®¾è®¡: `summarize` â†’ `checkQuality`
- ä»£ç è¡Œæ•°: 650 è¡Œ
- ç”Ÿæˆæ—¶é—´: 45 ç§’
- ä»£ç è´¨é‡: 92/100
- ä¸€æ¬¡è¿è¡ŒæˆåŠŸ: âœ…

### 13.2 æ‰¹é‡ç¿»è¯‘å·¥ä½œæµ

**ç”¨æˆ·æè¿°**:
```
ç¿»è¯‘å·¥ä½œæµï¼Œæ”¯æŒä¸­è‹±æ—¥äº’è¯‘ï¼Œå¸¦è´¨æ£€å’Œé‡è¯•ï¼Œæ‰¹é‡å¤„ç†å¤šä¸ªæ–‡æœ¬
```

**AI ç”Ÿæˆç»“æœ**:
- å·¥ä½œæµç±»å‹: `batch-translation`
- èŠ‚ç‚¹è®¾è®¡: `splitTexts` â†’ `translate` â†’ `checkQuality` â†’ `mergeResults`
- ä»£ç è¡Œæ•°: 850 è¡Œ
- ç”Ÿæˆæ—¶é—´: 60 ç§’
- ä»£ç è´¨é‡: 88/100
- ä¸€æ¬¡è¿è¡ŒæˆåŠŸ: âœ…ï¼ˆ1 å¤„å°è­¦å‘Šï¼Œè‡ªåŠ¨ä¿®å¤ï¼‰

### 13.3 SEO ä¼˜åŒ–å·¥ä½œæµ

**ç”¨æˆ·æè¿°**:
```
åˆ›å»ºä¸€ä¸ª SEO ä¼˜åŒ–å·¥ä½œæµï¼Œè¾“å…¥æ–‡ç« å†…å®¹ï¼Œåˆ†æå…³é”®è¯å¯†åº¦ã€æ ‡é¢˜æ ‡ç­¾ã€meta æè¿°ï¼Œç”Ÿæˆä¼˜åŒ–å»ºè®®
```

**AI ç”Ÿæˆç»“æœ**:
- å·¥ä½œæµç±»å‹: `seo-optimizer`
- èŠ‚ç‚¹è®¾è®¡: `analyzeKeywords` â†’ `checkStructure` â†’ `generateSuggestions`
- ä»£ç è¡Œæ•°: 720 è¡Œ
- ç”Ÿæˆæ—¶é—´: 50 ç§’
- ä»£ç è´¨é‡: 90/100
- ä¸€æ¬¡è¿è¡ŒæˆåŠŸ: âœ…

---

## 14. æœ€ä½³å®è·µå»ºè®®

### 14.1 è‡ªç„¶è¯­è¨€æè¿°æŠ€å·§

1. **æ˜ç¡®è¾“å…¥è¾“å‡º**: æ¸…æ¥šè¯´æ˜è¾“å…¥å‚æ•°å’ŒæœŸæœ›çš„è¾“å‡º
2. **æè¿°å…³é”®æ­¥éª¤**: è¯´æ˜ä¸»è¦çš„å¤„ç†æ­¥éª¤
3. **æåŠç‰¹æ®Šéœ€æ±‚**: å¦‚è´¨æ£€ã€é‡è¯•ã€æ‰¹å¤„ç†ç­‰
4. **æä¾›ä¸Šä¸‹æ–‡**: è¯´æ˜ä½¿ç”¨åœºæ™¯å’Œé¢†åŸŸ

**å¥½çš„æè¿°ç¤ºä¾‹**:
```
åˆ›å»ºä¸€ä¸ªæƒ…æ„Ÿåˆ†æå·¥ä½œæµï¼Œè¾“å…¥å®¢æˆ·è¯„è®ºæ–‡æœ¬ï¼Œè¾“å‡ºæƒ…æ„Ÿå€¾å‘ï¼ˆæ­£é¢/è´Ÿé¢/ä¸­æ€§ï¼‰å’Œç½®ä¿¡åº¦ï¼Œ
åŒ…å« LLM åˆ†ææ­¥éª¤å’Œè´¨é‡æ£€æŸ¥ï¼Œå¦‚æœç½®ä¿¡åº¦ä½äº 0.7 åˆ™é‡æ–°åˆ†æ
```

**ä¸å¥½çš„æè¿°ç¤ºä¾‹**:
```
æƒ…æ„Ÿåˆ†æ
```

### 14.2 AI é…ç½®ä¼˜åŒ–

```typescript
// AI æœåŠ¡é…ç½®
const AI_CONFIG = {
  // éœ€æ±‚ç†è§£ï¼šä½¿ç”¨æ›´å¼ºå¤§çš„æ¨¡å‹
  understanding: {
    model: 'claude-3-opus',  // æˆ– 'gpt-4'
    temperature: 0.3,         // é™ä½éšæœºæ€§
    maxTokens: 4000,
  },

  // ä»£ç ç”Ÿæˆï¼šä½¿ç”¨ä¸­ç­‰æ¨¡å‹
  generation: {
    model: 'deepseek-chat',   // æ€§ä»·æ¯”é«˜
    temperature: 0.7,         // é€‚ä¸­çš„åˆ›é€ æ€§
    maxTokens: 8000,
  },

  // éªŒè¯ä¼˜åŒ–ï¼šä½¿ç”¨å¿«é€Ÿæ¨¡å‹
  validation: {
    model: 'deepseek-chat',
    temperature: 0.1,         // ä½éšæœºæ€§
    maxTokens: 2000,
  },
};
```

### 14.3 æˆæœ¬æ§åˆ¶

```typescript
// æˆæœ¬ä¼˜åŒ–ç­–ç•¥
class CostOptimizer {
  // 1. ç¼“å­˜å¸¸è§æ¨¡å¼
  private patternCache = new Map<string, WorkflowRequirement>();

  async getCachedOrUnderstand(description: string): Promise<WorkflowRequirement> {
    const cacheKey = this.generateCacheKey(description);
    if (this.patternCache.has(cacheKey)) {
      return this.patternCache.get(cacheKey)!;
    }

    const requirement = await this.understandRequirement(description);
    this.patternCache.set(cacheKey, requirement);
    return requirement;
  }

  // 2. æ‰¹é‡å¤„ç†
  async batchGenerate(descriptions: string[]): Promise<WorkflowFiles[]> {
    // æ‰¹é‡è°ƒç”¨ APIï¼ŒèŠ‚çœæˆæœ¬
  }

  // 3. ä½¿ç”¨æ›´ä¾¿å®œçš„æ¨¡å‹è¿›è¡Œåˆæ­¥ç”Ÿæˆ
  async generateWithModelTier(
    requirement: WorkflowRequirement
  ): Promise<string> {
    // å…ˆç”¨ä¾¿å®œæ¨¡å‹ç”Ÿæˆ
    const draft = await this.generateWithModel(requirement, 'deepseek-chat');

    // å†ç”¨å¼ºå¤§æ¨¡å‹ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
    if (this.needsHighQuality()) {
      return this.optimizeCode(draft, 'claude-3-opus');
    }

    return draft;
  }
}
```

---

## 15. æ€»ç»“

### 15.1 æ ¸å¿ƒä»·å€¼

1. **æ•ˆç‡æå‡**: ä» 2-4 å°æ—¶ â†’ 5-10 åˆ†é’Ÿï¼ˆ12-48x æå‡ï¼‰
2. **ä½“éªŒä¼˜åŒ–**: ä» 20+ é—®é¢˜ â†’ 1 å¥è¯æè¿°
3. **è´¨é‡ä¿è¯**: AI åŸºäºæœ€ä½³å®è·µç”Ÿæˆï¼Œä»£ç è´¨é‡ç¨³å®š
4. **é™ä½é—¨æ§›**: æ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿåˆ›å»ºé«˜è´¨é‡å·¥ä½œæµ
5. **æŒç»­è¿›åŒ–**: AI ä»é¡¹ç›®ä¸­å­¦ä¹ ï¼Œè¶Šæ¥è¶Šæ™ºèƒ½

### 15.2 è®¾è®¡åŸåˆ™

- **AI-First**: æ‰€æœ‰æ ¸å¿ƒæµç¨‹ç”± AI é©±åŠ¨
- **ç”¨æˆ·å‹å¥½**: æç®€çš„äº¤äº’ä½“éªŒ
- **è´¨é‡ä¼˜å…ˆ**: è‡ªåŠ¨éªŒè¯ä¸ä¼˜åŒ–
- **å¯æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•
- **å¯é…ç½®**: çµæ´»çš„é…ç½®é€‰é¡¹

### 15.3 ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å¼€å§‹**: æŒ‰ç…§ 9.1 èŠ‚çš„å®æ–½è®¡åˆ’å¼€å§‹å¼€å‘
2. **æ”¶é›†åé¦ˆ**: ä»å›¢é˜Ÿä¸­æ”¶é›†è‡ªç„¶è¯­è¨€æè¿°ç¤ºä¾‹
3. **å‡†å¤‡æ•°æ®**: æ•´ç†ç°æœ‰å·¥ä½œæµä½œä¸º Few-Shot Learning æ•°æ®
4. **ä¼˜åŒ– Prompt**: æŒç»­è¿­ä»£ Prompt æ¨¡æ¿
5. **ç›‘æ§æŒ‡æ ‡**: æŒ‰ç…§ 12 èŠ‚çš„æ€§èƒ½æŒ‡æ ‡ç›‘æ§æ•ˆæœ

---

## é™„å½•

### A. æ–‡ä»¶ç»“æ„

```
src/presentation/cli/scaffolding/
â”œâ”€â”€ ai/                                    # AI æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ AINeuralUnderstandingEngine.ts    # éœ€æ±‚ç†è§£å¼•æ“
â”‚   â”œâ”€â”€ AIWorkflowDesigner.ts             # å·¥ä½œæµè®¾è®¡å™¨
â”‚   â”œâ”€â”€ AICodeGenerator.ts                # ä»£ç ç”Ÿæˆå™¨
â”‚   â””â”€â”€ prompts/                          # Prompt æ¨¡æ¿
â”‚       â”œâ”€â”€ understanding.ts
â”‚       â”œâ”€â”€ design.ts
â”‚       â”œâ”€â”€ generate-state.ts
â”‚       â”œâ”€â”€ generate-node.ts
â”‚       â”œâ”€â”€ generate-graph.ts
â”‚       â”œâ”€â”€ generate-factory.ts
â”‚       â””â”€â”€ validate.ts
â”œâ”€â”€ visualization/                         # å¯è§†åŒ–æ¨¡å—
â”‚   â”œâ”€â”€ VisualizationPreviewSystem.ts    # é¢„è§ˆç³»ç»Ÿ
â”‚   â”œâ”€â”€ MermaidDiagramGenerator.ts       # Mermaid ç”Ÿæˆå™¨
â”‚   â””â”€â”€ NodeTableGenerator.ts             # èŠ‚ç‚¹è¡¨ç”Ÿæˆå™¨
â”œâ”€â”€ validation/                            # éªŒè¯æ¨¡å—
â”‚   â”œâ”€â”€ AutoValidatorOptimizer.ts         # è‡ªåŠ¨éªŒè¯ä¼˜åŒ–å™¨
â”‚   â”œâ”€â”€ TypeScriptChecker.ts             # TS ç±»å‹æ£€æŸ¥
â”‚   â”œâ”€â”€ ESLintChecker.ts                 # ESLint æ£€æŸ¥
â”‚   â””â”€â”€ BestPracticeChecker.ts           # æœ€ä½³å®è·µæ£€æŸ¥
â”œâ”€â”€ schemas/                               # Schema å®šä¹‰
â”‚   â””â”€â”€ WorkflowRequirementSchema.ts      # éœ€æ±‚ Schema
â”œâ”€â”€ utils/                                 # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ contextBuilder.ts                # ä¸Šä¸‹æ–‡æ„å»º
â”‚   â”œâ”€â”€ patternExtractor.ts              # æ¨¡å¼æå–
â”‚   â””â”€â”€ codeFormatter.ts                 # ä»£ç æ ¼å¼åŒ–
â””â”€â”€ commands/                              # CLI å‘½ä»¤
    â””â”€â”€ create.ts                         # åˆ›å»ºå‘½ä»¤
```

### B. ç¯å¢ƒå˜é‡

```bash
# AI æœåŠ¡é…ç½®
AI_PROVIDER=deepseek                    # deepseek | openai | anthropic
DEEPSEEK_API_KEY=sk-xxx
OPENAI_API_KEY=sk-xxx
ANTHROPIC_API_KEY=sk-xxx

# å·¥ä½œæµè„šæ‰‹æ¶é…ç½®
SCAFFOLDING_AUTO_OPTIMIZE=true          # è‡ªåŠ¨ä¼˜åŒ–ç”Ÿæˆçš„ä»£ç 
SCAFFOLDING_INTERACTIVE=false           # é»˜è®¤äº¤äº’æ¨¡å¼
SCAFFOLDING_CACHE_ENABLED=true          # å¯ç”¨ç¼“å­˜
SCAFFOLDING_CACHE_TTL=3600             # ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰

# è´¨é‡é˜ˆå€¼
SCAFFOLDING_MIN_QUALITY_SCORE=80        # æœ€ä½è´¨é‡åˆ†æ•°ï¼ˆ0-100ï¼‰
SCAFFOLDING_AUTO_FIX_ERRORS=true        # è‡ªåŠ¨ä¿®å¤é”™è¯¯
```

### C. å‚è€ƒèµ„æ–™

- [LangGraph æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [DeepSeek API æ–‡æ¡£](https://platform.deepseek.com/api-docs/)
- [TypeScript æœ€ä½³å®è·µ](https://typescript-eslint.io/rules/)
- [Mermaid è¯­æ³•](https://mermaid.js.org/syntax/flowchart.html)

---

**æ–‡æ¡£ç»“æŸ**

> æœ¬æ–‡æ¡£æè¿°äº† AI-Native å·¥ä½œæµè„šæ‰‹æ¶å·¥å…·çš„å®Œæ•´è®¾è®¡ã€‚å®æ–½æ—¶è¯·ä¸¥æ ¼æŒ‰ç…§æ­¤æ–‡æ¡£æ‰§è¡Œï¼Œå¹¶æ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´ã€‚
>
> **æ ¸å¿ƒç†å¿µ**: è®© AI ç†è§£éœ€æ±‚ï¼Œè®© AI è®¾è®¡æ¶æ„ï¼Œè®© AI ç”Ÿæˆä»£ç ï¼Œè®© AI éªŒè¯è´¨é‡ã€‚å¼€å‘è€…åªéœ€ä¸€å¥è¯æè¿°ï¼Œå…¶ä½™äº¤ç»™ AIã€‚
